 1 On Automatic Fault Diagnosis in Wind Turbine Condition Monitoring Dhany Saputra and Kun Marhadi Brüel & Kjær Vibro, Nærum, 2850, Denmark Dhany.Saputra@bkvibro.com Kun.Marhadi@bkvibro.com  ABSTRACT Automatic Diagnosis is a novel algorithm developed by Brüel & Kjær Vibro to monitor various failure modes in wind turbines continuously. The algorithm aims at reducing false positives and false negatives, and most importantly, at eliminating the burden of diagnosis by human. Vibration analysis in the order domain using angular resampling helps to deal with speed variation in the vibration signal. The algorithm subsequently identifies prominent peaks in the order powerspectrum, labels these peaks, and then monitor the trends of any families of sidebands and harmonics. In this paper, we compare the results of Automatic Diagnosis with physical inspections using data from wind turbines monitored by Brüel & Kjær Vibro. Results show that Automatic Diagnosis can accurately detect the faults, as confirmed by physical inspections on the turbines. Diagnosing machine condition using high-performance computational infrastructure, instead of using a human, could hugely cut the cost of simultaneously monitoring many wind turbines. 1. INTRODUCTION A condition monitoring system (CMS) is vital for effective maintenance and ensuring maximum wind turbines uptime. It is even more crucial for offshore wind turbines. Andersson, Gutt, and Hastings (2007) presented CMS implementation in the wind turbine industry. Vibration-based CMS is the most established system for monitoring the drivetrain of wind turbines, as shown by Tavner (2012) and Crabtree (2011). Marhadi & Hilmisson (2013) presented a case study of using vibration data to monitor fault progression in the generator bearing of a wind turbine in real industrial applications. Marhadi & Hilmisson (2013) described that primary components monitored in wind turbine CMS are generator, gearbox, main bearing, and tower. Accelerometers are installed on these components, and there could be up to ten accelerometers installed in a wind turbine. The data acquisition unit in a wind turbine collects vibration data continuously from each sensor. Different vibration measurements, also known as descriptors, are used to monitor any fault development in a wind turbine. To monitor generator bearings, for example, several descriptors are used at different frequency ranges. Different failure modes can be monitored from various sensors using a different set of descriptors. According to Marhadi & Hilmisson (2013), all descriptors are trended to monitor specific failure modes. Alarm or warning of individual failure mode is triggered when the trend from specific descriptors crosses over predefined thresholds. Diagnostic engineers, subsequently, performs vibration analysis to confirm and describe the alarms. Szabó (2017) proposed a maximum correlated kurtosis deconvolution method to identify bearing inner and outer race fault. Works by Ali, Fnaiech, Saidi, Chebel-Morello, and Fnaiech (2015) and Ali, Saidi, Harrath, Bechhoefer, and Benbouzid (2018) proposed machine learning approach to assess bearing degradation using selected broadband descriptors. In this paper, we present Automatic Diagnosis that detects turbine faults automatically. The algorithm employs a naive approach to finding fault frequencies in powerspectrum. As opposed to previous works, where the anomaly is detected using a machine learning approach, Automatic Diagnosis uses well-known physics in vibration analysis. It does not require calculating broadband descriptors, such as in the previous work, because broadband descriptors are prone to generate false alarms. Nevertheless, with high-performance computing power, and an efficient algorithm, faults can be identified automatically, fast, and accurately. 2. AUTOMATIC DIAGNOSIS There are four essential strategies in Automatic Diagnosis algorithm: angular resampling, identification of peaks, priority labeling, and frequency tracking. Angular resampling 
Dhany Saputra et al. This is an open-access article distributed under the terms of the Creative Commons Attribution 3.0 United States License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited. 
------------------------------End of the page -----------------------------------
EUROPEAN CONFERENCE OF THE PROGNOSTICS AND HEALTH MANAGEMENT SOCIETY 2020 
2 is essential in performing accurate machine diagnosis as it overcomes speed variation issues and eliminates smearing in powerspectrum, thus making fault peaks clear and easy to track. Spectral peaks are identified based on the following criteria: 1. Signals larger than 3 dB relative to the spectrum carpet level are considered as peaks. As pointed out by Johnson (2006), 3 dB is the industry standard used as the boundary between high and low signal-to-noise ratios. 2. The carpet level is determined by performing median filtering. The window size of the median filtering depends on the machine characteristics, such as the turbine type. 3. Peaks are always local maxima. 4. For pruning purposes, chosen peaks should be within the first and third quantiles plus 1.5 interquartile range of all identified peaks. The chosen peaks are then prioritized and labeled according to the failure modes to be detected. For instance, on detecting a bearing fault, the running speed harmonics of the shaft are removed, then the bearing fault peaks such as inner race ball pass frequency (BPFI) and outer race ball pass frequency (BPFO) are identified. However, line frequency should always be the first to be removed as it is mainly related to electrical interference instead of mechanical faults. Some fault frequencies having the same priority, such as BPFO and sidebands of tooth meshing frequency (TMF), cannot be removed as they can coexist at the same frequency and accumulate in amplitude. Finally, peaks related to a known failure mode are then summed and trended over time as a descriptor. In other words, one failure mode is described by one descriptor. A unique feature in Automatic Diagnosis is its ability to track unknown bearing frequencies. When monitoring thousands of wind turbines from different turbine owners, the types of bearing installed in the turbine are often unknown. Therefore, frequency tracking is beneficial in the following three diagnosis cases: 1. The diagnosed shaft has only one bearing, and we have a list of possible bearing types. In that case, the bearing frequency consistently converges to a number when a bearing fault develops. However, this case is relatively infrequent as sensors usually crosstalk among each other. 2. The diagnosed shaft has many bearings, and we have a list of possible bearing types for each bearing position. In that case, the bearing fault peaks are grouped by bearing position, and the best bearing type is presented for each position. Bearing types will still be unknown until a fault develops. Nevertheless, when several bearings are failing, Automatic Diagnosis can identify which bearing is more severe than the others. The ability of the algorithm to identify the fault severity of multiple bearings solves the crosstalk issue. 3. No list of possible bearing types. In that case, the correct bearing frequencies can be predicted, given an adequately more extensive frequency search space. 3. EXAMPLES IN WIND TURBINE APPLICATIONS Over the years, Brüel & Kjær Vibro has managed to monitor more than 8000 turbines of various types from different manufacturers. We collect the descriptor scalars every half hour and the time waveform data from various sensors at different turbine components every two days. The time waveform is typically sampled at 25.6 kHz with a length of 10.24 seconds due to the limitations of the data acquisition unit. We use these time waveform data to perform Automatic Diagnosis over specific periods. We analyze wind turbines with gearbox configurations of one planetary and two helical stages (1P2H) and two planetary and one helical stages (2P1H). The terms frequency and order are used interchangeably. Faults are indicated by increases in the trends of Automatic Diagnosis descriptors, and criteria for automatic detection are determined beforehand. All faults presented in this work were confirmed with actual inspections of the turbines. Automatic Descriptor reports early-stage fault when a descriptor that represents the fault crosses an alert threshold. The descriptor may then progress towards a breakdown threshold, which means that the fault is developing towards a later stage. We use statistical inference and machine learning on a turbine population to update both thresholds. The more turbines we feed into the machine learning algorithm, the more accurate Automatic Diagnosis predicts early- and late-stage faults. More than 1,000 turbines were considered in this study to determine alert and breakdown thresholds for fault detection. 3.1. Generator-Gearbox Coupling Fault Figure 1 represents the order spectrum of the vibration signal from the generator drive end of a 2P1H, 3MW turbine, and there is an early-stage sign of misalignment between generator and gearbox. Figure 2 shows the order spectrum of the same sensor when the misalignment signature became severe. Figure 3 represents the trend of that misalignment signature calculated by Automatic Diagnosis over one and a half months. Tracing the fault development over time enables vibration analysts to observe the damage progression from when early signature occurs and perform prognosis. Misalignment was first detected on February 6th, 2015, indicated by the yellow arrow. When it became severe on February 17th, 2015, as indicated by the red arrow, the coupling was realigned.  
------------------------------End of the page -----------------------------------
EUROPEAN CONFERENCE OF THE PROGNOSTICS AND HEALTH MANAGEMENT SOCIETY 2020 
3  Figure 1. The order spectrum of a turbine with generator-gearbox misalignment (February 6th, 2015).  
 Figure 2. The order spectrum of a turbine with generator-gearbox misalignment (February 17th, 2015).  
 Figure 3. The trend of the twice of the generator running speed over 1.5 months. The yellow and red arrows are the misalignment peak amplitudes of the order spectrum shown in Figure 1 and Figure 2, respectively.  3.2. High-Speed Shaft Looseness Figure 4 shows the order spectrum of vibration signals from high-speed bearing at the generator side of a 1P2H, 2MW turbine when the looseness signature occurs, as shown by the high amplitudes of the high-speed shaft's running speed harmonics. Figure 5 represents the trend of looseness signature over half a year as calculated by Automatic Diagnosis. First, it was detected on December 22nd, 2016, as indicated by the yellow arrow, and it became severe by January 25th, 2017, as indicated by the red arrow.  
 Figure 4. The order spectrum of a turbine with severe high-speed shaft looseness (January 25th, 2017).  
 Figure 5. The trend of the Euclidean norm of high-speed shaft looseness peaks over half a year. The yellow and red arrows are the looseness values of the order spectrum shown in Figure 4 and Figure 5, respectively. 3.3. High-speed stage pinion fault Figure 6 shows the order spectrum of vibration signals from the intermediate-speed shaft front bearing of a 2P1H, 3MW turbine. There are sidebands with the spacing of generator speed around the first and the second harmonics of the TMF. Figure 7 shows the order spectrum when the pinion tooth is predicted as broken by Automatic Diagnosis. Here, the sidebands have much higher amplitudes.  
 Figure 6. The order spectrum of a turbine with early high-speed stage pinion fault (April 15th, 2013). 

------------------------------End of the page -----------------------------------
EUROPEAN CONFERENCE OF THE PROGNOSTICS AND HEALTH MANAGEMENT SOCIETY 2020 
4 As pointed out in Figure 8, the early-stage fault was detected as early as April 15th, 2013, as it rapidly increases towards the breakdown threshold. The trend continued to increase and remained high for many months. The existence of the pinion fault sidebands is on-and-off and erratic due to varying operating conditions. Automatic Diagnosis predicted a broken tooth by December 9th, 2014. The actual inspection was performed on February 19th, 2015, revealing a broken tooth of the high-speed stage pinion. Replacement of the gearbox was performed by the end of August 2016.  
 Figure 7. The order spectrum of a turbine with a very severe high-speed stage pinion fault. Most probably, the tooth has been broken at this point (December 9th, 2014).   
 Figure 8. The trend of the Euclidean norm of high-speed shaft pinion fault over 4.5 years. The yellow arrow is the point where Automatic Diagnosis alerted the early pinion fault. The red arrow is when the broken tooth was predicted. The green arrow is when the broken tooth was found. 3.4. High-speed stage wheel fault To detect wheel fault at the high-speed stage of a gearbox, Automatic Diagnosis monitors the Euclidean norm of all sideband amplitudes around the 3rd stage tooth mesh frequency (TMF) with the spacing of the running speed of the intermediate-speed shaft. Figure 9 shows the wheel fault sidebands around the TMF harmonics of a 2P1H, 3MW turbine. This case shows that Automatic Diagnosis could detect potential faults as early as three years before the damage is visible. Figure 10 shows the trend of the descriptor for a turbine having a high-speed stage wheel fault. This fault can be detected as early as January 2015, where the descriptor crossed the alert threshold predicted by Automatic Diagnosis. The overall trend continued to increase until the inspection was performed in May 2018.  During the inspection, the gear wheel was found to be corroded and damaged. Based on the finding, the wheel was recommended to be replaced. However, the turbine continues operating under this condition.  
 Figure 9. The order spectrum of a turbine with severe high-speed shaft gear wheel fault (September 26th, 2019). Red bars are the wheel fault sidebands around the TMF harmonics.   
 Figure 10. The trend of the Euclidean norm of high-speed shaft wheel fault sidebands over five years. 3.5. Intermediate-speed stage pinion fault Figure 11 shows the order spectrum of vibration signals from the intermediate-speed shaft of a 1P2H, 2MW turbine. Two harmonics families appeared, one group is on the lower frequency, namely intermediate-speed stage TMF, and the other group is on the higher frequency, namely high-speed stage TMF. Sidebands around high-speed stage TMF look higher than the intermediate-speed one, which a human might identify it as a high-speed pinion fault. However, considering that the magnitude of intermediate-speed stage vibration is lower than the high-speed stage one, the lower-speed stage TMF and the sidebands of its harmonics should already be considered severe. Therefore, on July 8th, 2015, sidebands around high-speed stage TMF are considered an early stage 

------------------------------End of the page -----------------------------------
EUROPEAN CONFERENCE OF THE PROGNOSTICS AND HEALTH MANAGEMENT SOCIETY 2020 
5 fault, while sidebands around intermediate-speed stage TMF harmonics are considered a more severe problem.  
 Figure 11. The order spectrum of a turbine with early intermediate-speed shaft pinion fault (July 8th, 2015). The first three TMF peaks are the intermediate-speed stage ones, and the last four TMF peaks are the high-speed stage ones.  Figure 12 showed the order spectrum of the same sensor when Automatic Diagnosis predicts a broken intermediate-speed stage pinion tooth. Here, the sidebands of the intermediate-speed stage TMF are higher than the ones in Figure 11. The high-speed stage TMF sidebands are still too early to be considered faulty because Automatic Diagnosis has learned much worse high-speed stage gear fault than this. As pointed in Figure 13, the early-stage fault was detected as early as July 8th, 2015, and the pinion tooth was predicted to break by September 17th, 2015. The actual inspection was performed on August 28th, 2015. According to the inspection report, it was also recommended to replace the pinion within 14 days, as identified similarly by Automatic Diagnosis. Replacement of the broken component was performed on October 2015.  
 Figure 12. The order spectrum of a turbine with severe intermediate-speed shaft pinion fault (September 17th, 2015). The first five TMF peaks are the intermediate-speed stage ones, and the last four TMF peaks are the high-speed stage ones.   Figure 13. The trend of the Euclidean norm of intermediate-speed shaft pinion fault over 4.5 years. The yellow arrow is the point where Automatic Diagnosis alerted the early pinion fault. The red arrow is when Automatic Diagnosis predicted the broken tooth. 3.6. First Stage Planetary Gear Fault A planetary stage in a wind turbine gearbox consists of a sun pinion, a ring gear, a planet carrier, and three or four planet gears. The planet gears revolve around the sun pinion while rotating on planet shafts at the same time. Once the planet gear finishes one revolution, the number of meshing teeth of the sun pinion becomes equal to the ring gear’s meshing teeth. Consequently, the ring gear and sun pinion fault frequencies equal to the number of planet gears times the meshing frequency over the number of gear teeth, while the planet gear fault frequency equals to the number of planets that are failing times meshing frequency over the number of planet gear teeth. Sidebands around planetary tooth mesh frequency with the spacing of planetary defect frequencies indicate the presence of planetary gear fault. Considering the planetary gears move at the same speed with the carrier shaft, sidebands with the spacing of the carrier shaft speed around planetary defect sidebands are used as a planetary gear fault indicator. Automatic Diagnosis algorithm tracks these sidebands of sidebands in the frequency order domain, as shown in Figure 14. The sun output shaft is used to resample this fault using a vibration data from a sensor near the planetary gear. Consequently, the 1P2H 2MW turbine in Figure 15 and Figure 16 was diagnosed as having a planetary defect. To identify whether the planetary gear fault is a sun pinion fault, a planet gear fault, or ring gear fault, Automatic Diagnosis requires the powerspectrum to be in very high resolution as the defect frequencies of the three gears are very similar. After replacing the planetary gear train, the sidebands of the sidebands drastically decreased back to normal. 

------------------------------End of the page -----------------------------------
EUROPEAN CONFERENCE OF THE PROGNOSTICS AND HEALTH MANAGEMENT SOCIETY 2020 
6  Figure 14. The trend of the Euclidean norm of planetary gear fault sidebands of tooth mesh frequency over a year  
 Figure 15. The order spectrum of a turbine with early-stage planetary gear fault (June 27th, 2011). The first stage TMF harmonics are too low to be considered as peaks, but the sidebands start to appear at low amplitudes. 3.7. Generator Bearing Inner and Outer Race Fault When the bearing fault frequencies, e.g., BPFI and BPFO, are unknown, the most probable frequencies must first be determined. It requires having an adequately broad frequency band to search. From this frequency search range, the fault frequency of the most apparent bearing fault in the high-frequency envelope is trended over time. Automatic Diagnosis tracks fault frequencies that consistently appear in this trend and use them to quantify bearing fault signatures at low frequency. The bearing fault is quantified as a descriptor. The descriptor is calculated as the Euclidean norm of the amplitudes of all possible harmonics of the predicted bearing frequency and the amplitudes of their sidebands, if any.   Figure 16. The order spectrum of a turbine with severe planetary gear fault (June 20th, 2012). The TMF harmonics might not be very high, but their sidebands are high.  Figure 17 displays the trends of bearing outer and inner race faults in a 2P1H, 3MW turbine. In general, the outer race fault indicated as the blue line is consistently high before July 2017, which is confirmed by a consistent trend of BPFO, indicated as an orange line, since January 1st, 2015. Meanwhile, the bearing inner race defect, indicated as a green line, starts to develop at the later stage since May 17th, 2016, confirmed by a consistent trend of BPFI, indicated as the red line, from May 17th, 2016, to July 2017. The shift of BPFI and BPFO values in August 2017 can be inferred as a change of generator bearing type. The predicted BPFO and BPFI fluctuate after August 2017, but the consistent frequency can be seen. This event indicates no bearing fault or mild bearing fault. After bearing replacement, the bearing fault trend is still relatively high, which could indicate a real bearing defect. Around spring 2018, the trend of the inner race bearing fault slightly increases, yet there is no indication of bearing change. This incident could be due to a misalignment issue, indicated as the purple line, since January 2018. Once the generator was realigned back by early summer 2018, the trend of the inner race defect returned to its previous level.  

------------------------------End of the page -----------------------------------
EUROPEAN CONFERENCE OF THE PROGNOSTICS AND HEALTH MANAGEMENT SOCIETY 2020 
7 4. PERFORMANCE EVALUATION OF AUTOMATIC DIAGNOSIS The performance of Automatic Diagnosis is evaluated by statistical measures called sensitivity, which quantifies the avoidance of false negatives, and specificity, which does the same for false positives. Feedbacks from turbine inspection is considered the actual machine condition. If Automatic Diagnosis detected a fault and inspection found nothing, then the number of false positives is incremented. If turbine inspection resulted in fault detection that Automatic Diagnosis does not identify that, then the number of false negatives is incremented. The number of true negatives is retrieved from routine turbine inspection, reporting that the turbine condition is excellent, and it concurs with Automatic Diagnosis reporting no fault. If some components are not inspected, then the uninspected component will not be included in the benchmark. There are 169 fault diagnoses from 24 turbines for this benchmark, 42 of them are confirmed faults based on physical inspection, the rest are either confirmed no faults or considered insignificant faults. Among all 169 diagnoses, 32 are planetary gear faults, 81 are bearing faults, 52 helical gear faults, two generator shaft unbalance faults, and two generator-gearbox coupling misalignment faults. The 81 bearing faults consists of 26 high-speed bearing faults, 11 intermediate-speed bearing faults, nine low-speed bearing faults, 19 planet bearing faults, and ten carrier bearing faults. The 52 helical gear faults consist of 14 high-speed stage pinion faults, 11 high-speed stage wheel faults, 16 intermediate-speed stage pinion faults, and 11 low-speed shaft wheel faults. The sensitivity, specificity, and accuracy of Automatic Diagnosis are 97.62%, 99.21%, and 98.82%, respectively, as calculated from the confusion matrix in Table 1. One false-negative case was because vibration data did not arrive when the fault occurred. One false-positive case happened because the signal sampling duration is not long enough for the requirement of low-speed shaft diagnosis, leading to an inaccurate diagnosis. Table 1. Confusion matrix of Automatic Diagnosis  Inspection Report Faulty Not Faulty Automatic Diagnosis Prediction Faulty 41 1 Not Faulty 1 126  5. CONCLUSION Automatic Diagnosis algorithm shows that faults can be detected automatically. These faults were confirmed by actual inspection. It shows that the sensitivity (97.62%) and specificity (99.21%) of Automatic Diagnosis are high, meaning that the number of false alarms is quite low. Consequently, there is a significant potential to replace human diagnosis with Automatic Diagnosis, which dramatically reduces the cost of condition monitoring many turbines. 
Figure 17. The trend of the outer and inner race defects on the generator bearing of a wind turbine over 4.5 years. Misalignment, outer race fault, and inner race fault are the Euclidean norms of the fault signature peaks in m/s2. BPFO and BPFI are in the order of generator running speed.  
------------------------------End of the page -----------------------------------
EUROPEAN CONFERENCE OF THE PROGNOSTICS AND HEALTH MANAGEMENT SOCIETY 2020 
8 REFERENCES Andersson, C., Gutt, S., & Hastings, M. (2007). Cost effective monitoring solution using external surveillance centre. In The second world congress on engineering asset management and the fourth international conference on condition monitoring. Harrogate, UK.  Tavner, P., (2012). Offshore Wind Turbines: Reliability. Availability and Maintenance, 441. Crabtree, C. (2011). Condition monitoring techniques for wind turbines (Doctoral dissertation, Durham University). Marhadi, K., & Hilmisson, R. (2013). Simple and effective technique for early detection of rolling element bearing fault: A case study in wind turbine application. In International congress of condition monitoring and diagnostic engineering management (pp. 94-97). Ali, J. B., Fnaiech, N., Saidi, L., Chebel-Morello, B., & Fnaiech, F. (2015). Application of empirical mode decomposition and artificial neural network for automatic bearing fault diagnosis based on vibration signals. Applied Acoustics, 89, 16-27. Szabó, L. (2017). Using maximum correlated kurtosis deconvolution method in the bearing fault detection of wind turbine generators. In 2017 14th International Conference on Engineering of Modern Electric Systems (EMES) (pp. 184-187). IEEE. Ali, J. B., Saidi, L., Harrath, S., Bechhoefer, E., & Benbouzid, M. (2018). Online automatic diagnosis of wind turbine bearings progressive degradations under real experimental conditions based on unsupervised machine learning. Applied Acoustics, 132, 167-181. Johnson, D. H. (2006). Signal-to-noise ratio. Scholarpedia, 1(12), 2088.  BIOGRAPHIES  Dhany Saputra is a data scientist in the Wind Business Unit of Brüel and Kjær Vibro, where he joined in 2018. He received his Ph.D. in Bioinformatics at the Technical University of Denmark in 2015. He has M.Sc. in Computer Science from Universiti Teknologi PETRONAS, Tronoh, Malaysia in 2008, and a B.Sc. in Information System from Sepuluh Nopember Institute of Technology Surabaya, Indonesia in 2005. His research interests are in machine learning and algorithm optimization. Kun S. Marhadi is a research and development engineer in the Wind Business Unit of Brüel and Kjær Vibro, where he joined in 2012. Previously, he was a postdoctoral fellow in the Department of Mathematics at the Technical University of Denmark (DTU). He received his Ph.D. in computational science in 2010 from San Diego State University and Claremont Graduate University. He has M.S. and B.S. in aerospace engineering from Texas A&M University. His expertise is in structural vibration and analyses, probabilistic methods, and design optimization.    
------------------------------End of the page -----------------------------------
