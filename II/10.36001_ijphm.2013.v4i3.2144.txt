 
International Journal of Prognostics and Health Management, ISSN 2153 -2648, 2013  014 Vibration Analysis and Time Series Prediction  for Wind Turbine  
Gearbox  Prognostics   
Sajid Hussain1 and Hossam A. Gabbar1,2 
1Faculty of Engine ering and Applied Science, University of Ontario Institute of Technology, 2000 Simcoe St. North, Oshawa, 
Ontario, Canada L1H7K4  
sajid.hussain @uoit.ca  
2Faculty of Energy Systems and Nuclear Science, University of Ontario Institute of Technology, 2000 Simcoe  St. North, 
Oshawa, Ontario, Canada L1H7K4  
hossam.gaber @uoit.ca  
 
ABSTRACT  
Multiple p remature failure s of a gearbox in a wind turbine 
pose a high risk of increas ing the operational and 
maintenance costs and decreasing the profit margins. 
Prognostics and health management (PHM) techniques are 
widely used to a ssess the current health conditi on of the 
gearbox and project it in future to predict premature failures . 
This paper pr oposes such techniques for predicting gearbox 
health condition index  extracted from the vibration signals. 
The progression of the monitoring index is predicted using 
two different prediction techniques , adaptive neuro -fuzzy 
inference system (ANFIS) and nonlinear autoregressive 
model with exogenous inputs (NARX) . The proposed 
prediction techniques are evaluated through sun-spot data -
set and applied on vibration based health related monitoring 
index calculated through psychoacoustic phenomenon.  A 
comparison is given for their prediction accuracy.  The 
results are helpful in understanding the relationship of 
machine conditions, the correspo nding indicating features, 
the level of damage/degradation , and their progression.  
1. INTRODUCTION  
There is a growing interest in renewable energy systems 
with increase d concerns over climate change . Wind energy 
has an attractive share in renewable energy bec ause it 
diversifies a resource portfolio and improves overall 
security  of the power system. However, t he engineering 
challenge for the wind industry is to design a reliable  wind 
turbine to harness wind energy and turn it into electricity . 
Despite all techn ological advancements in wind turbine 
design and installation, there is a price to pay in maintaining the wind turbine  in harsh operating environments and 
reduced accessibility.  According to two large surveys of 
European wind turbines, conducted over a spa n of 13 years, 
gearbox failure  is one of the h ighest risk events in wind 
turbines ( C. C. James , 2011 ). Hence, there is a need for 
efficient condition monitoring system for wind turbine 
gearbox . Condition monitoring is  a good tool to assess the 
damage early in time in order to plan the maintenance 
activities in a better way. Condition monitoring can be 
combined with opportunity maintenance to reduce the 
turbine’s unexpected downtimes.    
Typically, faults in wind turbine gearbox arise while in 
operation. Therefore, it is vital to detect, diagnose and 
analyze these faults as early as possible. The process should 
be non-destructive  in nature to avoid wind turbine’s 
disassembly.  This study presents fault detection, features 
extraction, and prognostics for wind turbine gearbox  based 
on vibration analysis . Vibration analysis is a non -destructive 
testing (NDT) technique widely used in the industry and in 
academia.   
1.1. Classification of Vibration Signals  
Vibration signals  emanating f rom the rotating gearbox are 
analyzed to ascertain the current condition of the gearbox.  
Vibration signals can be classified into stationary and non -
stationary , and based on this classification , the nature of 
their analysis methods differ . For stationary signals, 
vibration analysis methods are divided into  two domains, 
namely time and frequency . Time -domain m ethods include 
statistical , model based , and signal processing based 
methods. F requency -domain methods include spectrum and 
cepstrum  based methods. Fo r non -stationary signals, joint 
time-frequency vibration analysis methods such as short 
time Fourier transform ( STFT)  and wavelet analysis (WA) 
(Hui Li  et al., 2011 ) are used  for fault detection in 
_____________________  
Sajid Hussain et al. This is an open -access article distributed under the 
terms of the Creative Commons Attribution  3.0 United States License, 
which permits unrestricted use, distribution, and reproduction in any 
medium, provided the original author and source are credited.  
------------------------------End of the page -----------------------------------
INTERNATIONAL JOURNAL OF PROGNOSTICS AND HEALTH MANAGEMENT  
2 gearboxes . Other methods of non -stationary analysis  for 
gearboxes  include Wigner -Ville distribution, Hilbert -Haung 
transform , and kurtogram  analysis  (Jerome Antoni , 2007 ). 
1.2. Features Extraction  
The features extraction  system extracts characteristic 
signatur es from raw vibration signals  emanating from 
gearbox . The extracted features should reflect the changes in 
the gearbox’s  health condition s over time.  As discussed 
earlier, th e vibration based signal processing analysis is one 
of the most common  non-destructive  technique s. Also, with 
suitable vibration analy sis, we can detect many different 
faults related with gearboxes.  We use vibration based 
features extraction  to extract  the information that best 
represents the faulty conditions present in the monitored 
equipment . Different methods for vibration based feat ures 
extraction in gearbox fault diagnosis framework have been 
proposed in research  (Halima, E. B . et al, 2008, J. Rafiee  et 
al, 2010). In time-domain , vibration based features such as 
kurtosis  and spectral kurtosis  are extensively used  (F. 
Combet  et al, 2009) . Other studies including statistical -
based and transient -based features detection are performed 
in the past  (Hiram Firpi  and George Vachtsevanos , 2008; V. 
Indira  et al, 2010) . A comprehensive list of time -domain  and 
frequency -domain  features for fault detection  and diagnosis 
of gearboxes is discussed in  (Yaguo Lei  et al, 2010) . 
1.3. Prognostics  
Prognostic  plays a very important role  in an a ccurate and 
reliable decision making . Prognostics can be used 
effective ly in  utilization and maintenance  of ma chinery 
systems . Prognostics use s different machines health related 
indices including temperature  (Jamie Coble  et al, 2010 ), oil-
debris analysis  (Richard Dupuis , 2010 ), acoustics, and 
vibration  (Eric Bechhoefer  et al, 2010 ). Among these, 
vibration based prognostics is quite common . In (B. 
Samanta and C. Nataraj, 2008 ), researchers have used 
different health monitoring indices in gearboxes such as 
gear-wear, gear -chipped, gear -crack, gear -pitting, and shaft 
misalignment for projecting the gearbox health in formation 
in future. They have used neuro -fuzzy approaches for 
modeling and prediction of gearbox dynamics. A 
comprehensive review on prognostics is presented in  
(Andrew K.S . et al, 2006 ), where decision making process 
based on diagnostics and prognostics is discussed. 
Prognostic is performed by estimating the temporal 
evolution of the features over time  (Wang W ., 2007 ). In 
vibration based prognostics, vibration signals emanating 
from sensitive components inside the gearbox are recorded , 
health related feat ures are extracted , and time series 
prediction techniques are applied to the features trends for 
prognostics  (L. Gelman et al, 2012 ). Statistical, evolutionary 
and soft computing approaches are used to estimate the 
predictors and the use of neural networks  and neuro -fuzy 
methods are very common.  This paper proposes a novel method to extract machine’s 
health related vibration  features based on psychoacoustic 
phenomenon  along with  neural networks and neuro -fuzzy 
approaches for prognostics. In this study, other than 
vibration features, we also use sunspot data for measuring 
the performance of the designed predictors.  The rest of the 
paper is organized as follows. Section 2  is the methodology 
section where we  propose the novel feature extraction 
technique based on psychoacoustics phenomenon  followed 
by wavelet smoothing and prediction approaches. S ection 3 
simulates the proposed techniques on sunspot data and real-
world vibration data emanating from a planetary gearbox 
inside a wind  turbine . Finally, s ection 4 concludes the paper.  
2. THE METHODOLOGY  
The process of  vibration based features extraction and 
prognostic is shown in  Figure  1. Below we discuss each 
module one by one.  
 
Figure 1. The process of prognostic  
2.1. Transient Based Features Extraction  
The vibration features extraction algorithm presented in this 
section works on the principle of transient analysis. 
Transients are very short and abrupt changes in sound waves 
due to non -linearity. Non -linearity could be mechanically 
introduced disturbances in electromechanical systems or 
unwanted clicks in transmission lines. The transient analysis 
algorithm calculates a real time estimate of transients caused 
by non -linearity as perceived by the human ear.  The 
analyzer uses the knowledge about human ear’s nature of 
filtering the signals as presented in  (E. Zwicker,  and H. 
Fastl , 2009 ). The filtering operation ensures that the 
transients are detected in a way that matches the nature of 
the cochlea and thereby as perceived by the human ear. 
Transient analysis gives a much better correlation to the 
perceived quality of sound than traditional measurements 
based on frequenc y analysis.  
The vibration features extraction algorithm  uses principles 
of auditory models developed  by the auditory physiologists  
(S. Seneff , 1988 ). According to psychoacoustic  theory, 
pulses with sh ort rise time or fall time contain a broad 

------------------------------End of the page -----------------------------------
INTERNATIONAL JOURNAL OF PROGNOSTICS AND HEALTH MANAGEMENT  
3 spectrum of  frequencies. Therefore , it is possible to detect 
the instantaneous energy in frequency bands in the transient 
range of the ear.  A common method for doing this is to use 
a filter bank containing a group of band -pass filters covering 
the frequency  interval of  interest. The purpose of the band 
pass filters is to detect the pulse s in the frequency  band 
where the pulse s have most energy as perceived by the 
human ear. It will be the  filter where the shape of the 
impulse response  of the band -pass filter  matches bes t the 
shape of the  pulse s but reverse in time .  A gamma tone filter 
bank is used in this study as shown in  Figure  2. First 
design ed by Patterson and Holdworth  (R. D. Patterson  et al, 
1992 ), gamma tone filter bank is an array of band -pass filters 
which simulates the response of the human ear ’s cochlea. At 
each point along the cochlea, a psychoacoustic measure of 
the width of the auditory filter is represented by an 
equivalent rectangular bandwidth  (ERB).  
 
Figure 2. The gammatone filter bank  
The ERB is a psychoacoustic  measure of a filter ’s 
bandwidth in the filter bank. The bandwidth of a filter  
increases with an increase in its center frequency. T he 
relationship between ERB and center frequency 
cF  Hz is 
given by the following equation  
 
24.7 0.108 .cERB F
                 (1) 
 
The impulse response of a band -pass filter is defined by the 
following relation  (R. D. Patterson  et al, 1992 ): 
 
 12cos 2 .N mt
ch t Rt e F t
               (2) 
 
Where  
R is an arbitrary factor that is typically used to 
normalize the peak magnitude transfer to unity,  
Nis the 
filter order, 
m is a parameter that determines the duration of 
the impulse response and thus the filter’s bandwidth, 
cF  is 
the filter’s center frequency,  and 
 is the phase of the tone.  
Figure 3 shows an impulse response  of a gammatone filter  
with 
1000cF Hz , 
125m Hz  and 
4N . To detect the 
energy in the channels the output signal s from the band -pass 
filter  bank  are Hilbert transformed. Hilbert transform detects the envelop es of the band -pass filtered  signal s and extracts 
the instantaneous energy of the faulty pulses.  Hilbert 
transform can be expressed as  
1 1 ( )ˆ( ) ( ) * .xx t x t d
tt
  


       (3) 
Hilbert transform creates a n artificially complex  signal  
()ut 
from  
()xt . The real part 
()xt  of the  
()ut is the original 
signal and the imaginary part 
ˆ()xt  is the Hilbert transform 
of the real part. Thus, 
()ut is defined as  
ˆ ( ) ( ) ( )u t x t jx t . 
The magnitude and phase of 
()ut is computed as  
22ˆ ( ) ( ) ( )A t x t x t
 and 
ˆ()( ) arctan()xttxt . The 
magnitude 
()At is the envelope of  the signal and is always 
a positive function . 
 
Figure 3. Gammatone filter impulse response  
After the pulses are extracted through envelop e detection  or 
Hilbert transform , feature extraction block follows . In the 
feature extraction block, amplitude s and s lopes of the pulses 
are calculated as  per Eq. (4 ) and Figure 4.    
  
.rHigh Reference Level Low Reference LevelS
Rise Time  (4) 
 
Figure 4. Calculation of amplitude and slope of a pulse  
Amplitude (max imum  magnitude) is a linear detector for 
pulses in the full frequency area. S lope is very sensitive for 
catching nonlinear sounds in the high frequency area. Both 

------------------------------End of the page -----------------------------------
INTERNATIONAL JOURNAL OF PROGNOSTICS AND HEALTH MANAGEMENT  
4 metrics can be summarized to a logarithmic index 
expressing the amount and size of the pulses. The inde x may 
be based on either the magnitude s or the s lopes of the pulses. 
It is expected that pulses with a short rise time will be more 
annoying to the ear, than pulses with longer rise times.  Thus, 
by considering the pulse envelope, it seems reasonable to 
focus the measure on the s lope in the leading edge. Every 
transient detecte d is characterized by the 80% amplitude and 
the maximum s lope in the leading edge. In order to obtain 
an equal number of detected transients in each frequency 
bands, the output from the transient analyzer is split into 
blocks of a pre -specified duration. T he duration is found as 
a trade -off between preserving the complexity of the 
measurement and having an equal number of detected 
transients in each channel. In each block, only the transient 
with the maximum s lope is gathered. The maximum s lope is 
found by differentiating the signal and finding maximum 
amplitude of the differentiated signal. The logarithmic index 
is calculated as follows  
2
,1
10 21
10.log .BN
max ij
i channels j BC
refSS
NN
Vb
S





       (5) 
Where  
SVb  is vibration steepness index,  
i is index for band 
pass filter and 
CN is total number of band pass  filters used. 
Index of sub -blocks in a band pass filtered signal is 
j  and 
BN
 is the total number of sub -blocks. The maximum 
steepness in band pass filter  
i and sub -block 
j  is
max ijS . 
The argument for squaring the maximum steepness  in Eq. (5)  
is simply to put the large steepness values in favor .  
1refS  
if the  measured amplitude is  acceleration . For amplitude 
index  
AVb , 
max ijS in Eq . (5) is replaced by 
max ijA
where 
maxA  is the maximum amplitude of the non -
differentiated envelop e signal.  The vibration features 
extracted are de -noised through wavelet de -noising 
techniques and normalized before prediction.  
2.2. Wavelet Denoising  
Features extracted from real signals emanating from 
complex dynamical systems p ose a serious problem of 
noise. Therefore, it is important  to de -noise the extracted 
features before modeling is performed  (Uros Lotric  and 
Andrej Dobnikar , 2005) . De-noising the signal is o ne of the 
most effective applications of wavelets in signal processing . 
The wavelet transform -based  de-noising method s can 
produce much higher de -noising quality than conventional  
methods. Furthermore, the wavelet transform -based method s retain  the details of a signal after de -noising  
(Edmundo G. de Souza e Silva  et al, 2010).  Wavelets are 
limited duration, undulatory mathematical functions . The 
time integral of wavelet functions equals to zero.  Figure 5 
plots some common wavelets. Similar to Fourier transform, 
where we use sine s and cosine s as basis functions, wav elet 
transform uses wavelets as basis functions . Wavelets are 
used in many different fields including compression,  signal  
processing, and de -noising ( Graps, A , 1995 ). In Fourier 
analysis, we approximate a function 
fx  by sines and 
cosines functions with different frequencies and amplitudes. 
Thus, the approximation equation becomes    
   
1^
sin cos .o i i
kf x a a kx b kx

       (6) 
Where,
oa , 
ia , and 
ib  are calculated from Fourier 
transform as  
 ω.jtF f t e dt


        (7) 
Wavelet analysis is performed in the similar way as Fourier 
transform but with scaled and translated versions of mother 
wavelet 
x  as basis functions. M other wavelet can be 
any one from Figure  5 and the scaling and translation is 
defined as child wavelets and can be calculated as  
 ,2.j
jkx x k 
        (8) 
Where 
 is a constant, 
k  is wavelet translation and 
2j is 
scale translation. We can estimate 
fx  from the following 
equation in wavelet analysis   
 ,^
,
,.
jkjk
jkf x c x 

 
       (9) 
Where , 
,jkc are the wavelet coefficients and are obtained 
through the wavelet transform  as 
,,.j k j kc f x x dx 

     (10) 
Each coefficient 
,jkc  obtained in Eq. (10) is a contribution 
of the wavelet 
,jkx  in the whole approximation for t he 
original signal. If the value of this coefficient 
,jkc  is very 
small and its contribution to the approximation is considered 
negligible, we can omit the corresponding child wavelet 
,jkx
 from the approximation. This procedure is called 
------------------------------End of the page -----------------------------------
INTERNATIONAL JOURNAL OF PROGNOSTICS AND HEALTH MANAGEMENT  
5 thresholding  and it forms the basis for the wavelet de -
noising. Wavelet analysis basis functions are finite and 
limited to one size and this makes wavelet analysis useful 
technique for detecting local featu res like discontinuities 
and spikes  in a signal . On the other hand, Fourier analysis 
basis functions are infinite in nature and an approximation 
of a specific part of the signal a ffects the entire signal. 
Wavelet analysis is joint time -frequency analysis t echnique 
as contrast to the Fourier transform that is purely frequency 
analysis. This feature makes wavelet analysis to detect when 
in time a particular event took place. Wavelet smoothing or 
wavelet trend analysis is used to remove high frequency 
componen ts from the extracted features which can be 
assumed as noise.  
 
 
 
 
 
Figure 5. Commonly used wavelets (a) Daubechies           
(b) Gaussian (c) Morlet  2.3. Time Series Prediction  
The prediction of time series  
xt  at 
r time steps ahead, 
trx
, is obtained  based on its values at present and past time 
steps 
 2 12, ,..., , , [ , ]t mr t r t r t t m r t m rx x x x x x       as 
 2 12, , ,..., , , . ()t r t mr t r t r t t m r t m rx x x x x x x       
 Where 

 is a predictor functions and can be approximated through 
various conventional, statistical and artificially intelligent 
techniques like Bayesian, support vector regression, 
adaptive neuro-fuzzy inference system  (ANFIS) and neural 
networks (NN). This pape r uses a dynamic neural network 
called  the nonlinear autoregressive model with exogenous 
inputs (NARX) and ANFIS techniques to approximate the 
predictor function 
 . 
2.3.1.  The NARX  
The NARX is a dynamic neural network, used for modeling 
nonlinear dynamical systems. The NARX can be 
represented mathematically as  

,..., 1 ;
1.
, 1 ,..., 1y
uy n y n d
y n f
u n u n u n d

  


      (11) 
Where,  
nu  and 
ny  are the input and output of the 
system at time step  
n, while 
1ud  and 
1yd , 
uydd , 
are the input -memory and output -memory  orders.  Equation 
(11) can also be written in compact form  as 
 1; y n f n nyu
 , where 
nu  and 
ny  are 
the input and output regressor vectors respectively.  The 
nonlinear mapping function  
.f  is approximated through a 
multi -layer perception (MLP) algorithm trained with plain 
back propagation algorit hm. This research deals with 
nonlinear univariate time series prediction and for this we 
set 
0yd . This reduces the NARX network to time delay 
neural network (TDNN) architecture and Eq . (11) reduces to  
(T. Lin  et al, 1997 )  
 1 , 1 ,..., 1 .uy n f u n u n u n d    
   (12) 
Figure  6 shows the way the NARX is trained and tested. 
During the training phase, the feedback loops (dotted lines 
in Figure 6) are not used.  During the testing or prediction 
phase, if multistep -ahead predictions are requir ed, the output 
values are fed back to both the input regressor  
nu  and 
the output regressor 
ny  at the same time. Thus, the 
resulting predictive model contains two feedback loops, one 
for the input regressor and another for the output regressor.  

------------------------------End of the page -----------------------------------
INTERNATIONAL JOURNAL OF PROGNOSTICS AND HEALTH MANAGEMENT  
6 2.3.2.  The adaptive neuro -fuzzy inference system  
The basic structure of the ANFIS is shown in Figure 7. The 
ANFIS has 
m inputs 
12, ...,mx x x , each with 
n  
membership functions (MFs), 
R  rules and one output 
y . 
When the ANFIS predicts a time series, the inputs are 
  ( 1) ( 2) 2, , ,..., , ,t mr t m r t m r t r t r tx x x x x x      
 and the output 
of the ANFIS is 
tryx . In the above mentioned case, the 
ANFIS predicts the time series 
r  time steps ahead based on 
current and the previous 
m  values. We use a Sugeno -fuzzy 
type inference system with five layers and 
4m  inputs. 
Number of nodes 
N  in layer 1 is the product  of number of inputs 
m  and the input MFs 
n  for each input, i.e., 
. N m n
. Number of nodes in layers 2 -4 is equal to the number of 
rules 
R  in the fuzzy rule base. Layer 1 is a fuzzufication 
layer and it transforms the crisp inputs 
ix  to linguistic labels 
ijA
. The examples of the linguistic labels are small, 
medium, large etc., and the transforma tion occurs with some 
degree of the MFs as
1
ij ijOx . Where , 
1,...,im , 
1,...,jn
 and 
ij represents the  
thj  membership function 
for the input 
ix . Different types of MFs are used like 
triangular, trapeziodal, Gaussian etc. Layer 2 of the ANFIS 
is a product layer,  where for each node  
k, the output 
represents weighting  factor or firing strength of the  rule 
R 
 
Figure 6. NARX training and testing  
(Feedback loops are required only during testing)  
 
Figure 7. Basic structure of ANFIS  
------------------------------End of the page -----------------------------------
INTERNATIONAL JOURNAL OF PROGNOSTICS AND HEALTH MANAGEMENT  
7 associated with 
k . The output  
kw  of this layer is  
2
k ik iOx
, and it  is the product of all its inputs 
scaled according to the MFs 
ik .Where  
1,...,im  and 
1,...,kR
. Layer 3 is a normalization layer and the output 
of each node  
k in this layer represents the normalized  
weighting factor 
__
kw  of the 
thk rule as  
3 k
k
kkwO
w  . 
Where  
1,...,kR . Layer 4 is a de -fuzzification layer and 
the output of each node in this layer is a weighted output of 
the first order Sugeno -type fuzzy if -then rule as 
__
4
k k kO w f
. Where
k kj j k
jf p x r , 
1,...,jn , 
1,...,kR , 
kf 
is the  output of the  
thk  rule, and the parameters  
kjp  and 
kr
 are called consequent parameters. Layer 5 is the final 
output layer and it contains only one node inside. The 
output of the layer 5 is an overall output  
y of the network 
as
__
5
kk
kO w f . It is also a sum of all the weighted  
outputs of the rules.  We need a training dataset of desired 
input/output pairs  
 12, ,..., ,m x x x y to train the ANFIS or 
model the target system. In training phase, the ANFIS 
adaptively maps the input features space 
 12, ,...,m x x x   
to the corresponding output  
y. The mapping in the ANFIS 
system is done through the membership functions (MFs), 
the rule base and the related parameters that emulate the 
training dataset. The training phase  of the ANFIS uses 
hybrid learning method. It uses the gradient descent 
approach for fine tuning the parameters that define the MFs 
and applies the least squares method to identify the 
consequent parameters that define the coefficient of each 
output equati on in Sugeno -type fuzzy rule base. The training 
process continues till the desired stopping criteria is 
reached, i.e., number of epochs or error tolerance.  
3. SIMULATIONS AND DISCUSSIONS  
In this section, the prediction accuracy of both the time 
series predict ors, NARX and ANFIS is compared using 
standard dataset of sunspot activity for years 1749 -2012  
(RWC Belgium World Data Center, 2012) . The sunspot 
activity data has non -linear, non -Gaussian and non -
stationary characteristics and is suitable to test the 
performance of the predictors . The entire dataset of sunspot 
activity was normalized between [0 - 1] and used for 
training  and testing  both NARX and ANFIS predictors. To 
get a reliable prognosis, the data need to be less sensitive to 
noise. This requirement  can be reached using selected signal processing techniques such as wavelet smoothing  or 
denoising discussed in section 2.2 . For wavelet denoising, 
we use Daubechies wavelet (db4) with nine levels. The 
threshold technique is set to soft th reshold , and the thr eshold 
rule used is universal . The universal  threshold rule is 
defined as 
2 log( ) L . Where  
Lis the signal  length . We 
also set the rescaling method as single level where the 
algorithm considers the noise as white and estimates the 
standard deviation of the noise from the wavelet coefficient 
at the first level. We use the normalized Akaike Information 
Criteria (AIC) for  assessing the prediction performance. The 
AIC can be formulated as  (Akaike H . 1974 ). 
22ln .uAIC
P
  (13) 
Where 
2 is the variance of the prediction error, 
u is the 
number of model parameters to b e updated and 
P is the 
total number of data points in the predicted dataset.  A 
smaller value of AIC indicates better prediction 
performance. The sunspot activity  data contains 3166 
points. For both types of predictors, 70% data is used for 
training,  15% for testing, 15% for validation , and 500 
training epochs . Computation was carried out in MATLAB® 
environment on a PC with Intel Core i7  with 8 GB of RAM.  
One step ahead prediction is performed and in one step 
ahead prediction, the tar get 
( 1)yn is calculated from 
previous four values ,
()xn ,
( 1)xn , 
( 2)xn , and 
( 3)xn
.The input memory we use is 
4ud . Table 1 shows  the 
mean absolute error ( MAE ) and AIC for NARX and ANFIS  
for sunspot data . The number of membership functions for 
ANFIS is 3 with 16 fuzzy rules and 104 parameters. The 
AIC achieved is -4.457. The neuro -fuzzy  system proposed 
in (Wang WQ  2004 ) with the sam e datasets produced AIC 
of 1.527. The ANFIS method gave better prediction 
performance  as compared to ( Wang WQ  2004 ) for the same 
datasets. The  sunspot  training and test datasets were also 
used for assessing the prediction performance of NARX . 
For NARX , MAE  of testing  is 0.0034 .  
Figure 8(a) shows the sunspot activity data along with 
wavelet smoothing. NARX and ANFIS prediction results 
are shown in Figure 8(b) and 8(c) along with error box -plots 
in Figure 8(d), respectively . In Figure 8(d), the medians of 
the box -plots are centered at zero for both NARX and 
ANFIS predictors and the  
2.698  lines are at  
0.01  
showing about 99.3% of the error observations within the 
range of  
0.01 . Where  
 is the error’s standard deviation. 
There are some outliers for both NARX and ANFIS cases 
and NARX depicts better performance as compared to 
ANFIS in this case. In the case of NARX, the MAE  value is 
approximately same as ANFIS (sunspot data -set) in Table 1 .  
In the framework of machine condition  monitoring , it is 
very important to know well in advance the expected 
behavior of a machine system for its proper operation and 
------------------------------End of the page -----------------------------------
INTERNATIONAL JOURNAL OF PROGNOSTICS AND HEALTH MANAGEMENT  
8 maintenance scheduling without any major interruptions. 
Severa l approaches are adopted to monitor the system 
behavior  and v ibration -based approaches are quite popular  
for condition  monitoring.  
 
 
 
 
Figure 8. Sunspot data , wavelet smoothing and prediction  The desirable monitoring index should be highly sensitive  to 
the fault -related vibration with low sensitivity to noise.  The 
selection of monitoring index involves different steps of  
signal processing and feature extraction. These also greatly  
depend on the type of machine faults . The vi bration index 
we use is proposed in section 2.1 . The experimental 
vibration data  emanate from a planetary gearbox inside  a 
wind turbine. The data are provided by the National 
Renewable Energy Laboratory (NREL), through a 
consortium called the Gearbox Reliability Collaborative 
(GRC)  (H. Link  et. al. 2011) . The gearbox under test is one 
of two units taken from the field and redesigned, rebuilt and 
instrumented with over 125 sensors.  The gearbox first 
finished its run -in in the NREL dynamometer test facil ity 
(DTF) and later was sent to a wind plant close to NREL for 
field test, where two oil losses occurred.  
 
 
Figure 9. (a) Planetary g earbox (b) GRC Drive train 
Configuration  
(Courtesy of National Renewable Energy Laboratory)  
 
The test turbine in the field is a stall -controlled, three -
bladed, upwind turbine with a rated power of 750kW. The 
turbine generator operates at 1200 RPM and 1800 RPM 
nominal on two different sets of windings depending on the 
power. The planetary gearbox has an ove rall ratio of  
1:81.491. It is composed of one low speed (LS) planetary 
stage and two parallel stages as shown in Figure 9. This 
study uses data from test case CM_2a with main shaft speed 
of 14.72 RPM and high speed shaft (HSS) speed of 1200 
RPM. The data a re collected  at a sampling frequency of 
40KHzsF
. Figure 10(a) shows an example of a raw 
(b) 
(c) 
(d) 
(a) 
(b) 
(a) 
------------------------------End of the page -----------------------------------
INTERNATIONAL JOURNAL OF PROGNOSTICS AND HEALTH MANAGEMENT  
9 vibration signal, 1sec (40000 samples) in length, collected 
from the gearbox inside the windmill.  
 
 
 
 
Figure 10. (a) Raw vibration signal (one sample)               
(b) Vibration index trend (350 samples) (c) one -step 
prediction NARX (d) one -step prediction ANFIS  
A total of 350 such vibration signals are  analyzed in this 
section.  Vibration indices are calculated as prop osed in section 2 .1. For both types of predictors, 70% data is used 
for training, 15% for testing, 15% for validation, and 500 
training epochs. Computation was carried out in MATLAB® 
environment on a PC with Intel Core i7 with 8GB of RAM.  
Figure 10(a) shows an example of a raw vibration signal, 
1sec (40000 samples) in length, collected from the gearbox 
inside the windmill. A total of 350 such vibration signals are 
analyzed in this section.  Vibration indices are calculated as 
proposed in sec tion 2 .1. Figure 10(b) shows the vibration 
index trend with wavelet smoothing.  The vibration index is 
gradually increasing with time. It is because of the oil loss 
occurred in the field test. The oil loss caused the gearbox to 
run dry and consequently, a g radual increase in the overall 
vibration levels and vibration index is observed.  Figure 
10(c) shows one step prediction for NARX and Figure 10(d) 
shows one step prediction for ANFIS.  In one step ahead 
prediction, the target 
( 1)yn   is calculated from previous 
four values, 
()xn , 
( 1)xn , 
( 2)xn , and 
( 3)xn .The 
input memory we use is 
4ud .  
 
 
Figure 11. One-step ahead recursive prediction  (a) NARX              
(b) ANFIS  
NARX seems to exhibit more promising  results as 
compared to ANFIS in this case. Also, the MAE error value 
for NARX is less as shown in Table 1 (vibration index data -
set). We can also use one step recursive predict ion for 
NARX and ANFIS to predict as many future values as we 
want as shown in Figures 11(a) and 11(b). For multi -step 
recursive prediction, we have to loop the output values back 
as discussed in section 2.3.1 in the NARX case ( feedback 
(b) 
(c) 
(d) 
(a) 
(b) (a) 
------------------------------End of the page -----------------------------------
INTERNATIONAL JOURNAL OF PROGNOSTICS AND HEALTH MANAGEMENT  
10 dotted lines in Fig ure 6). Similar strategy is adopted in the 
ANFIS case.  
4. CONCLUSION  
Two different techniques are used for predicting  the wind 
turbine gearbox  health related vibration based index  trend . 
The pr ediction  performance of the predictors, NARX and 
ANFIS, is illustr ated on two data -sets, sunspot activity and 
vibration index. Both the NARX and ANFIS predictors 
perform quit well in this study.  Results show the 
effectiveness of the predictors in estimating the variations of 
the monitoring indices. In this work, one -step-ahead and 
recursive multi -step ahead prediction is considered  for both 
the NARX and ANFIS cases.  Although, the 
k step ahead 
prediction  is not performed in this research, it can be done 
easily by predicting the target 
()y n k with the previous  
values
()xn , 
()x n k , 
( 2 )x n k , 
( 3 )x n k and so on.   
The potential application of these techniques for the 
development of on -line prognost ic and estimation of 
remaining useful life (RUL) for machine condition is under 
consideration for further work.  
 
 
 
 
 
 
 
ACKNOWLEDGEMENTS  
Authors and thankful to  the National Ren ewable Energy 
Laboratory (NREL) for providing  the wind turbine’s 
gearbox vibration data  through a consortium called the 
Gearbox Reliability Collaborative (GRC) .  
 
REFERENCES  
Akaike H. A new look at the statistical model identification  
(1974) . IEEE Trans Automat Control . vol. 17, pp. 716–
23. 
Andrew K.S. Jardine, D aming Lin, and Dragan Banjevic  
(2006) . A review on machinery diagnostics and 
prognostics implementin g condition -based 
maintenance. Mechanical Systems and Signal 
Processing , vol.  20, no.7, pp. 1483 –1510.  
B. Samanta and C. Nataraj (2008). Prognostics of machine 
condition using soft compu ting. Robotics and 
Computer -Integrated Manufacturing , vol. 24, no. 6, pp. 
816-823. 
C. C. James. , (2011). Condition monitoring techniques for 
wind turbines . Doctoral dissertation , Durham 
University, UK. http://etheses.dur.ac.uk/652/ . E. Zwicker,  and H. Fastl  (2009). Psychoacoustics - Facts 
and Models . Springer 2nd edition . 
Edmundo G. de Souza e Silva, Luiz F.L. Legey and 
Edmundo A. de Souza e Silva  (2010). Forecasting oil 
price trends using wavelets and hidden markov models . 
Energy Economics , vol. 32, pp. 1507 –1519.  
Eric Bechhoefer, Steve Clark, and David He  (2010). A 
state-space model for vibration based prognostics . 
Annual Conference of the Prognostics and Health 
Management Society , October 10 -16, Portland, Oregon 
USA.  
F. Combet , L. Gelman  (2009). Optimal filtering of gear 
signals for early damage detection based on the spectral 
kurtosis . Mechanical Systems and Signal Processing , 
vol. 23, no. 3, pp. 652-668. 
Graps, A.  (1995). An introduction to wavelets . IEEE 
Computational Science and Engineering , vol. 2, no. 2 , 
PP. 50–61. 
H. Link, W. LaCava, J. van Dam, B. McNiff, S. Sheng, R. 
Wallen, M. McDade, S. Lambert, S. Butterfield, and F. 
Oyague  (2011). Gearbox reliability collaborative 
project report: Findings from Phase 1 and Phase 2 
Testing.  NREL/TP -5000 -51885 . 
Hui Li, YupingZhang,  and Haiqi Zheng  (2011). Application  
of H ermitian wavelet to crack fault detection in 
gearbox . Mechanical Systems and Signal Processing , 
vol. 25, pp. 1353 –1363.    
Halima, E. B., Shoukat Choudhury, M. A. A., Shah, S. L. , 
and Zuo , M. J. (2008). Time domain averaging across 
all scales: a novel method for detection of gearbox 
faults . Mechanical Systems and Signal Processing , vol. 
22, no. 2, pp. 261-278. 
Hiram Firpi  and George Vachtsevanos  (2008). Genetically  
programmed -based  artificial feature -extraction applied 
to fault d etection . Engineering Applications of Artificial 
Intelligence , vol. 21, no. 4, pp. 558-568. 
J. Rafiee , M.A. Rafiee , P.W. Tse (2010). Application of 
mother wavelet functions for automatic gear and 
bearing fault diagnosis . Expert Systems with 
Applications , vol. 37, no. 6, pp. 4568 -4579.  
Jerome Antoni  (2007). Fast computation of the kurtogram  
for the detection of transient faults . Journal of 
Mechanical systems and Signal Processing , vo. 21, no. 
1, pp. 108-124. 
L. Gelman, I. Petrunin,  I. K. Jennions, and M. Walters 
(2012). Diagnostics of local tooth damage in gears by 
the wavelet  technology . International Journal of 
Prognostic and Health Management , vol. 3, no. 2. 
R. D. Patterson, K. Robinson, J. Holdsworth, D. McKeown, 
C.Zhang, and M. H. Allerhand  (1992). Complex sounds 
and auditory images . Auditory physiology and 
perception, Proc. 9th International Symposium on 
Hearing , Pergamon, Oxford, pp. 123 -177. 
Richard Dupuis  (2010). Application of oil debris monitoring 
for wind turbine  gearbox prognostics and health  
management . Annual Conference of the Prognostics 
Data Set  Model  MAE  MSE  AIC 
Sunspot  NARX  0.0034  2.144x10-5 -4.943  
ANFIS  0.0035  2.421x10-5 -4.457  
Vibration  
Index  NARX  0.0013  3.626x10-6 -3.467  
ANFIS  0.0086  4.079x10-4 -3.134  
 
Table 1. MAE , MSE ans AIC  – NARX and ANFIS  
------------------------------End of the page -----------------------------------
INTERNATIONAL JOURNAL OF PROGNOSTICS AND HEALTH MANAGEMENT  
11 and Health Management Society , October 10 -16, 
Portland, Oregon USA.    
RWC Belgium World Data Center, Online sunspot data 
archive, SIDC , [Online]. Available: [Cited: 20th Dec, 
2012]:  http://sidc.oma.be/index.php3 . 
S. Seneff (1988). A J oint Synchrony/mean -rate M odel of 
Auditory Speech Processing. Journal  of Phonetics , vol. 
16, no.1, pp. 55-76. 
T. Lin, B. G. Horne, P. Tino, and C. L. Giles  (1997). A 
delay damage model selection a lgorithm  for NARX 
neural n etworks . IEEE Transactions on Signal 
Processing , vol. 45, no. 11, pp. 2719 –2730 . 
Uros Lotric  and Andrej Dobnikar  (2005) . Predicting time 
series using neural networks  with wavelet -based  
denoising layers. Neural Computing and Applications , 
vol. 14, pp. 11–17. 
V. Indira, R. Vasanthakumari  and V. Sugumaran  (2010). 
Minimum sample size determination of vib ration 
signals in machine learning approach to fault diagnosis 
using power analysis . Expert Systems with Applications , 
vol. 37, no.12, pp. 8650 -8658.  
Wang W . (2007). An adaptive predictor for dynamic system 
forecasting . Mechanical Systems and Signal 
Proces sing, vol. 21, no. 2, pp. 809–23. 
Wang WQ  (2004) , Golnaraghi MF, Ismail F. Prognosis of 
machine health conditionusing neuro -fuzzy systems. 
Mech Syst Signal Process . Vol. 18, pp. 813–31. 
Yaguo Lei, Ming J. Zuo, Zhengjia He,  and Yanyang Zi  
(2010). A multidimensional hybrid intelligent method 
for gear fault diagnosis . Expert Systems with 
Applications , vol. 3 7, no. 2, pp. 1419 -1430.  
BIOGRAPHIES  
Sajid Hussain  is a PhD student in Electrical and Computer 
Engineering at University of Ontario Institute of 
Technology (UOIT) working under supervision of Dr. 
Hossam A. Gabbar. He did his diploma in Signal Processing 
from Aalborg University Denmark in 2003 and MSc in 
Telecommunication from Technical University Denmark in 
2006. He worked as a Research Assistant in Computer 
Systems Engineering at Blekinge Institute of Technology, 
Sweden for two years. He is the author of more than 18 
publications in the area of computer graphics, vibration analysis and risk -based maintenance. He also holds a patent 
in psychoacoustics  for fault detection in electromechanical 
machines. He has 10 years of industrial experience in 
computer systems and machines condition monitoring.  
Dr. Hossam A. Gabbar  is Associate Professor in the 
Faculty of Energy Systems and Nuclear Science, and cross 
appointed in the Faculty of Engineering and Applied 
Science, University of Ontario Institute of Technology 
(UOIT). He obtained his Ph.D. degree (Safety Engineering) 
from  Okayama University (Japan), while his undergrad 
degree (B.Sc.) is in the area of automatic control from 
Alexandria University, Egypt. He is specialized in safety 
and control engineering where he worked in process control 
and safety in research and industr ial projects in Japan and 
Canada. Since 2004, he was tenured Associate Professor in 
the Division of Industrial Innovation Sciences at Okayama 
University, Japan. And from 2001, he joined Tokyo Institute 
of Technology and Japan Chemical Innovative Institute 
(JCII), where he participated in national projects related to 
advanced distributed control and safety design and operation 
synthesis for green energy and production systems. He 
developed new methods for automated control recipe 
synthesis and verification, safety design, and quantitative 
and qualitative fault simulation.  
He is a Senior Member of IEEE, the founder of SMC 
Chapter - Hiroshima Section, the founder and chair of the 
technical committee on Intelligent Green Production 
Systems (IGPS), and Editor -in-chief of International Journal 
of Process Systems Engineering (IJPSE), president of 
RAMS Society, and editorial board of the technical 
committee on System of Systems and Soft Computing 
(IEEE SMCS). He is invited speaker in several Universities 
and interna tional events, and PC / chair / co -chair of several 
international conferences. Dr. Gabbar is the author of more 
than 110 publications, including books, book chapters, 
patent, and papers in the area of safety and control 
engineering for green energy and pro duction systems. His 
recent work is in the area of risk -based safety and control 
design for energy conservation and supply management, and 
smart grid modeling and planning with distributed 
generation.   
 
 
------------------------------End of the page -----------------------------------
