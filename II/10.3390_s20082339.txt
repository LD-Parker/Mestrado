sensors
Article
Fault Diagnosis of Wind T urbine Gearbox Based on
the Optimized LSTM Neural Network with
Cosine Loss
Aijun Yin1,2,*, Yinghua Yan1,2, Zhiyu Zhang1,2, Chuan Li3and Ren √©-Vinicio S √°nchez4
1State Key Laboratory of Mechanical Transmissions, Chongqing University, Chongqing 400044, China;
201807021027@cqu.edu.cn (Y.Y.); 20170702004t@cqu.edu.cn (Z.Z.)
2College of Mechanical Engineering, Chongqing University, Chongqing 400044, China
3Research Center of System Health Maintenance, Chongqing Technology and Business University,
Chongqing 400067, China; chuanli@ctbu.edu.cn
4Department of Mechanical Engineering, Universidad Polit √©cnica Salesiana, Cuenca 010105, Ecuador;
rsanchezl@ups.edu.ec
*Correspondence: aijun.yin@cqu.edu.cn; Tel.: +86-135-0838-4505
Received: 2 March 2020; Accepted: 16 April 2020; Published: 20 April 2020
/gid00030/gid00035/gid00032/gid00030/gid00038/gid00001/gid00033/gid00042/gid00045 /gid00001
/gid00048/gid00043/gid00031/gid00028/gid00047/gid00032/gid00046
Abstract: The gearbox is one of the most fragile parts of a wind turbine (WT). Fault diagnosis of the
WT gearbox is of great importance to reduce operation and maintenance (O&M) costs and improve
cost-e ectiveness. At present, intelligent fault diagnosis methods based on long short-term memory
(LSTM) networks have been widely adopted. As the traditional softmax loss of an LSTM network
usually lacks the power of discrimination, this paper proposes a fault diagnosis method for wind
turbine gearboxes based on optimized LSTM neural networks with cosine loss (Cos-LSTM). The loss
can be converted from Euclid space to angular space by cosine loss, thus eliminating the e ect of signal
strength and improve the diagnosis accuracy. The energy sequence features and the wavelet energy
entropy of the vibration signals are used to evaluate the Cos-LSTM networks. The e ectiveness of
the proposed method is veriÔ¨Åed with the fault vibration data collected on a gearbox fault diagnosis
experimental platform. In addition, the Cos-LSTM method is also compared with other classic fault
diagnosis techniques. The results demonstrate that the Cos-LSTM has better performance for gearbox
fault diagnosis.
Keywords: wind turbine; gearbox fault; cosine loss; long short-term memory network
1. Introduction
With the gradual depletion of non-renewable energy and the deteriorating human living
environment, wind energy has developed rapidly as one renewable energy source [ 1]. However,
wind turbines (WTs) are mostly installed in remote areas as the main equipment for wind power
generation. The harsh operating environment causes frequent failures of key components such as
gearboxes and bearings [ 2]. Therefore, in order to ensure the safe operation of WTs and reduce the
operation and maintenance (O&M) costs, it is crucial to study e ective fault diagnosis methods for
gearboxes [3].
As the vibration and acoustic emission signals are sensitive to the faults of the machine, condition
monitoring systems based on vibration [ 4,5] and acoustic emission [ 6‚Äì8] have been widely used in the
Ô¨Åeld of condition monitoring and fault diagnosis. In order to monitor the health conditions of WTs,
the wind energy industry is currently using condition monitoring systems to collect large amounts
of real-time data for diagnosing gearbox faults. Since the amount of data collected from gearboxes
is increasing, the traditional fault diagnosis method cannot e ectively analyze massive data and
Sensors 2020 ,20, 2339; doi:10.3390 /s20082339 www.mdpi.com /journal /sensors
------------------------------End of the page -----------------------------------
Sensors 2020 ,20, 2339 2 of 13
automatically give accurate diagnosis results [ 9]. Therefore, intelligent fault diagnosis methods based
on artiÔ¨Åcial intelligence techniques are gaining more attention. Generally, there are two main steps for
intelligent fault diagnosis methods: feature extraction and fault classiÔ¨Åcation [ 10]. Traditional methods
such as artiÔ¨Åcial neural networks (ANN) and support vector machine (SVM) are used to classify
faults [ 11‚Äì13]. However, the problem of existing intelligent fault diagnosis methods is that the common
machine learning methods rely on well-selected features and have limited ability to learn from complex
time-series signals; meanwhile, with these methods it is more di cult to identify faults under variable
working conditions, and they have a low classiÔ¨Åcation accuracy. Therefore, a more e ective fault
identiÔ¨Åcation method is needed. [ 14‚Äì17]. In recent years, deep learning has attracted great attention
from various Ô¨Åelds due to the powerful ability of feature learning and the superiority of processing
massive data. Up to now, deep learning networks have been widely applied in fault diagnosis, such
as deep belief networks (DBN) [ 18], convolutional neural networks (CNN) [ 19] and recurrent neural
networks (RNN) [ 20]. However, the gearbox has strong time-dependence of faults due to its relatively
long operating time [ 21]. Compared with other deep learning methods, the long short-term memory
(LSTM) neural network has great advantages in learning long-term time-dependent characteristics of
sequences [22,23].
For the fault diagnosis methods based on LSTM neural networks, the softmax cross entropy
is usually used as the loss function of fault classiÔ¨Åcation. However, recent studies found that the
traditional softmax loss is insu cient to acquire the discriminating power for classiÔ¨Åcation. To obtain
better discriminating performance, Wang et al. [ 18] proposed a novel loss function called large margin
cosine loss (LMCL) for learning the high-resolution depth features used in face recognition. The result
shows that the loss function based on cosine distance has a good e ect on classiÔ¨Åcation. Therefore,
this paper proposes an optimized fault diagnosis method using an LSTM network with cosine loss
(Cos-LSTM) to improve the ability of classiÔ¨Åcation. Meanwhile, the energy sequence features and the
wavelet energy entropy of the fault vibration data collected on a gearbox fault diagnosis experimental
platform are used to validate Cos-LSTM networks. The Cos-LSTM achieves higher accuracy of
diagnosis, which is demonstrated through the gear transmission experiments and compared to other
fault diagnosis methods.
The rest of the paper is organized as follows. In Section 2, the typical architecture of LSTM and
the process of fault diagnosis are brieÔ¨Çy introduced. Section 3 details the Cos-LSTM method and
the process of gearbox fault diagnosis based on the Cos-LSTM method. The gearbox fault diagnosis
experiment and the comparisons of our proposed method and other fault diagnosis methods are
presented in Section 4. Finally, the conclusions are drawn in Section 5.
2. LSTM Neural Network for Fault Diagnosis
As a special type of recurrent neural network (RNN), the LSTM neural network was proposed by
Hochreiter and Schmifhuber [ 24] to solve the vanishing or exploding gradient problem of RNNs [ 25],
while retaining the ability of RNNs to process sequential data. In this section, we describe LSTM in
more detail.
2.1. Structure of LSTM
The main component of an LSTM neural network is the LSTM cell, which can decide whether to
update the state information of a memory cell. The structure of the LSTM cell is shown in Figure 1.
------------------------------End of the page -----------------------------------
Sensors 2020 ,20, 2339 3 of 13
Sensors 2020 , 20, x FOR PEER REVIEW 3 of 13 
 X(t)g(t)
i(t)h(t-1)
f(t)*
**
o(t)h(t)
s(t)
sigm sigm sigmtanh tanh C(t)
 
Figure 1. The Schematic diagram of an LSTM cell. 
As shown in Figure 1,  h(t) and x(t) are the output hidden states and inputs of the current time 
step, ‚Ñé(ùë°‚àí1) represents the hidden state of the previous time step; sigm is the sigmoid function and 
tanh is the hyperbolic tangent function. C(t) is a memory cell which is used for the preservation of 
information, and the flow of information into or out of C(t) is regulated by three different gates: 
1. The input gate  i(t), which decides whether the information can get in the memory element; 
2. The forget gate  f(t), which decides whether the internal information needs to be forgotten; 
3. The output gate  o(t), which decides what information can pass through the gate and get into the 
rest of the neural network.  
The internal state node s(t) and  input node g(t) are also integral parts of the LSTM cell. Here are 
the calculation procedures of the LSTM cell: 
() ( () ( 1 ) )gxg h g gtW x t W h tb=Œ¶ + ‚àí + , (1) 
() ( () ( 1 ) )ix ih i it Wxt Wht bœÉ=+ ‚àí + , (2) 
() ( () ( 1 ) )fxf h f ftW x t W h tbœÉ=+ ‚àí + , (3) 
() ( () ( 1 ) )ox oh o ot W xt W ht b œÉ=+ ‚àí + , (4) 
() () *() ( 1 ) * ()stg t i t C t f t=+ ‚àí, (5) 
() ( () ) * ()ht st ot =Œ¶. (6) 
In the above equations, Wjx, W jh and bj, ,, , jgjfo=  denote the input weight matrixes, hidden 
weight matrixes and bias vectors separately; ‚àó, œÉ and –§ are element-wise multiplications of two 
vectors, the  sigmoid  function and tanh function, respectively.  
The LSTM neural network can learn when to open or close the gate to control the flow of 
information in LSTM cells automatically, so it ca n choose useful information to train the model. 
2.2. Architecture of LS TM for Fault Diagnosis 
The LSTM neural network is used for fault classification in fault diagnosis. The architecture for 
the LSTM network includes five layers: an input layer, an LSTM hidden layer, a fully connected layer, a softmax layer and a result output layer at the en d. The architecture of the LSTM network is shown 
in Figure 2. 
Figure 1. The Schematic diagram of an LSTM cell.
As shown in Figure 1, h(t) and x(t) are the output hidden states and inputs of the current time
step, h(t 1) represents the hidden state of the previous time step; sigm is the sigmoid function and
tanh is the hyperbolic tangent function. C(t) is a memory cell which is used for the preservation of
information, and the Ô¨Çow of information into or out of C(t) is regulated by three di erent gates:
1. The input gate i(t),which decides whether the information can get in the memory element;
2. The forget gate f(t), which decides whether the internal information needs to be forgotten;
3. The output gate o(t), which decides what information can pass through the gate and get into the
rest of the neural network.
The internal state node s(t) and input node g(t) are also integral parts of the LSTM cell. Here are
the calculation procedures of the LSTM cell:
g(t) =F(Wgxx(t) +Wghh(t 1) +bg), (1)
i(t) =(Wixx(t) +Wihh(t 1) +bi), (2)
f(t) =(Wf xx(t) +Wf hh(t 1) +bf), (3)
o(t) =(Woxx(t) +Wohh(t 1) +bo), (4)
s(t) =g(t)i(t) +C(t 1)f(t), (5)
h(t) =F(s(t))o(t). (6)
In the above equations, Wjx,Wjhand bj,j=g,j,f,odenote the input weight matrixes, hidden
weight matrixes and bias vectors separately; ,andFare element-wise multiplications of two vectors,
thesigmoid function and tanh function, respectively.
The LSTM neural network can learn when to open or close the gate to control the Ô¨Çow of
information in LSTM cells automatically, so it can choose useful information to train the model.
2.2. Architecture of LSTM for Fault Diagnosis
The LSTM neural network is used for fault classiÔ¨Åcation in fault diagnosis. The architecture for
the LSTM network includes Ô¨Åve layers: an input layer, an LSTM hidden layer, a fully connected layer,
a softmax layer and a result output layer at the end. The architecture of the LSTM network is shown
in Figure 2.
------------------------------End of the page -----------------------------------
Sensors 2020 ,20, 2339 4 of 13
Sensors 2020 , 20, x FOR PEER REVIEW 4 of 13 
 LSTM cell LSTM cell LSTM cell LSTM cell...
Input 
layerLSTM 
hidden 
layer
Classification 
output layer
Datax(0) x(1) x(2) x(n)h(0) h(1) h(2) h(n)Fully 
connected 
layer
Softmax 
layer
Trained by cross-entropy 
cost functionOutput
 
Figure 2. The architecture for LSTM network. 
During the training process, the fault features are fed into the input layer first, then the data flow 
through LSTM cell and the result of LSTM cell is output to the LSTM hidden layer. The last output 
of the LSTM hidden layer is taken as the output of the LSTM network, and it is used to connect a fully 
connected layer to map outputs into the result sp ace. The softmax layer follows the fully connected 
layer to calculate the probabilities for all the faul t pattern. Finally, the fault diagnosis results are 
output to the classification output layer. After co mpleting the training, the weights and bias will be 
adjusted to the optimal value, and then the test set is input into LSTM for fault diagnosis.  
3. Cos-LSTM 
The softmax cross entropy is ofte n used as the loss function of the LSTM neural network; 
however, the softmax loss is insufficient to enable classification [26,27]. To solve this problem, the 
cosine loss function is adopted to optimize the LSTM neural network. This section provides details about the Cos-LSTM. 
3.1. Cosine Loss 
Based on the softmax loss, the cosine loss reta ins its advantage of enlarging the difference 
between classes [15], but reduces its sensitivity to different signal strengths and pays more attention to the difference of vectors in direction. The sc hematic of cosine loss is shown in Figure 3.  
X
ZY
q1
p1Cos(…µ)Dist(q 2,p1)
Dist(q 1,p1)q2
 
Figure 3. Schematic of Cosine Loss. 
Suppose there are two signals ùëû‡¨µ and ùëû‡¨∂ with the same fault, and the corresponding fault label 
is ùëù‡¨µ.When softmax is taken as the loss function, th e softmax loss can be formulated as follows, 
Figure 2. The architecture for LSTM network.
During the training process, the fault features are fed into the input layer Ô¨Årst, then the data Ô¨Çow
through LSTM cell and the result of LSTM cell is output to the LSTM hidden layer. The last output of
the LSTM hidden layer is taken as the output of the LSTM network, and it is used to connect a fully
connected layer to map outputs into the result space. The softmax layer follows the fully connected
layer to calculate the probabilities for all the fault pattern. Finally, the fault diagnosis results are output
to the classiÔ¨Åcation output layer. After completing the training, the weights and bias will be adjusted
to the optimal value, and then the test set is input into LSTM for fault diagnosis.
3. Cos-LSTM
The softmax cross entropy is often used as the loss function of the LSTM neural network; however,
the softmax loss is insu cient to enable classiÔ¨Åcation [ 26,27]. To solve this problem, the cosine
loss function is adopted to optimize the LSTM neural network. This section provides details about
the Cos-LSTM.
3.1. Cosine Loss
Based on the softmax loss, the cosine loss retains its advantage of enlarging the di erence between
classes [ 15], but reduces its sensitivity to di erent signal strengths and pays more attention to the
dierence of vectors in direction. The schematic of cosine loss is shown in Figure 3.
Sensors 2020 , 20, x FOR PEER REVIEW 4 of 13 
 LSTM cell LSTM cell LSTM cell LSTM cell...
Input 
layerLSTM 
hidden 
layer
Classification 
output layer
Datax(0) x(1) x(2) x(n)h(0) h(1) h(2) h(n)Fully 
connected 
layer
Softmax 
layer
Trained by cross-entropy 
cost functionOutput
 
Figure 2. The architecture for LSTM network. 
During the training process, the fault features are fed into the input layer first, then the data flow 
through LSTM cell and the result of LSTM cell is output to the LSTM hidden layer. The last output 
of the LSTM hidden layer is taken as the output of the LSTM network, and it is used to connect a fully 
connected layer to map outputs into the result sp ace. The softmax layer follows the fully connected 
layer to calculate the probabilities for all the faul t pattern. Finally, the fault diagnosis results are 
output to the classification output layer. After co mpleting the training, the weights and bias will be 
adjusted to the optimal value, and then the test set is input into LSTM for fault diagnosis.  
3. Cos-LSTM 
The softmax cross entropy is ofte n used as the loss function of the LSTM neural network; 
however, the softmax loss is insufficient to enable classification [26,27]. To solve this problem, the 
cosine loss function is adopted to optimize the LSTM neural network. This section provides details about the Cos-LSTM. 
3.1. Cosine Loss 
Based on the softmax loss, the cosine loss reta ins its advantage of enlarging the difference 
between classes [15], but reduces its sensitivity to different signal strengths and pays more attention to the difference of vectors in direction. The sc hematic of cosine loss is shown in Figure 3.  
X
ZY
q1
p1Cos(…µ)Dist(q 2,p1)
Dist(q 1,p1)q2
 
Figure 3. Schematic of Cosine Loss. 
Suppose there are two signals ùëû‡¨µ and ùëû‡¨∂ with the same fault, and the corresponding fault label 
is ùëù‡¨µ.When softmax is taken as the loss function, th e softmax loss can be formulated as follows, 
Figure 3. Schematic of Cosine Loss.
------------------------------End of the page -----------------------------------
Sensors 2020 ,20, 2339 5 of 13
Suppose there are two signals q1andq2with the same fault, and the corresponding fault label is
p1. When softmax is taken as the loss function, the softmax loss can be formulated as follows,
Losssoft=1
BBX
i=1 log(ekWikkxkcosi
NP
j=1ekWjkkxkcosj) (7)
where Bis the number of training samples and Nis the number of classes, xand W represent the hidden
layer output and the weight matrix respectively, and is the angle between W and x.Formula (2)
suggests that softmax loss is related to signal strength, while cosine loss evaluates the size of the
dierences between classes according to cosine similarity between the two feature vectors. The cosine
similarity is deÔ¨Åned as follows:
similarity (A,B) =AB
kAkk Bk=nP
i=1AiBi
s
nP
i=1A2
is
nP
i=1B2
i(8)
Taking 1‚Äîcosine similarity as the loss function, the cosine loss can be formulated as follows,
Losscos=1
BBX
i=11 yis
NP
j=1y2
j=1
BBX
i=1s
1 kWik2kxk2cosi2
PkWjk2kxk2cosj2(9)
By Formula (5), the kxk2in this formula can be eliminated, so the cosine loss is independent of the
signal strength. Therefore, taking cosine loss function as the loss function in gearbox fault diagnosis,
the loss can be converted from Euclid space to angular space, thus eliminating the e ect of signal
strength and reduce the burden of network Ô¨Åtting.
3.2. The Process of Cos-LSTM for Fault Diagnosis
In this paper, there are two kinds of fault features extracted for evaluating the proposed method:
the energy sequence feature and the wavelet energy entropy.
The energy sequence feature: The energy sequence features are extracted by wavelet packet
decomposition (WPD). WPD is a signal decomposition tool that decomposes a signal to some nodes
and every node represents a set of coe cients at a speciÔ¨Åed frequency band [ 28,29]. The wavelet
packet is deÔ¨Åned as follows:
(t) =p
2X
kh(k)(2t 1) (10)
Y(t) =p
2X
kg(k)(2t 1) (11)
where h(k)and g(k)are a low-pass Ô¨Ålter and a high-pass Ô¨Ålter respectively. ?(t)andY(t)represent
the scaling function and the wavelet function respectively. Additionally, g(k)can be expressed by h(k)
using the formula g(k)= ( 1)kh(1 k).
The signal is decomposed by Equations (12) and (13)
dj+1,2n(t) =X
l2Zhl 2kdj,n(t) (12)
dj+1,2n+1(t) =X
l2Zgl 2kdj,n(t) (13)
------------------------------End of the page -----------------------------------
Sensors 2020 ,20, 2339 6 of 13
where jdenotes the decomposition layer, n2n
0, 1, 2,:::, 2j 1o
is the number of nodes in layer j,l
indicates the number of wavelet coe cients and dj,nrepresents the coe cient sequence at the jth layer,
nth node.
Due to the large amount of data, we divided the vibration data into four segments and a three-layer
WPD was performed on each segment of vibration data using Daubechies 3 (db 3) to obtain eight
nodes [30‚Äì32]. The energy of each node Ej,ncould then be calculated through Formula (14)
Ej,n=X
kdj,n(k)2. (14)
The total energy of the signal Eis the sum of the energy of each node in layer three. It can be
computed by (15):
E=23 1X
n=0Ej,n. (15)
andPj,nis deÔ¨Åned by (16):
Pj,n=Ej,n
E. (16)
Each of the signals can be decomposed to get eight nodes, and the energy sequences feature can
be expressed as Equation (17) according to Equations (14)‚Äì(16).
x(i) = ( Pv1
2,i,Pv2
2,i) (17)
where x(i)is the energy sequences feature and i=0, 1,:::, 7,Pv1
2,iand Pv2
2,iindicate the P2,ifor
sv1(t)andsv2(t), which denote the vibration signals of the gearbox in the horizontal and vertical
directions respectively.
Wavelet energy entropy: The signal is reconstructed according to the eight node coe cients
obtained from the three-layer WPD above, and the reconstructed signal is divided into Nsegments
on the basis of the time characteristics of the signal. The energy of each segment is calculated by
Formula (14). The calculated energy is normalized by Formulas (15) and (16) to obtain the wavelet
energy entropy. The wavelet energy entropy of the j-th layer nnode of the WPD is deÔ¨Åned as Hj,n,
and can be formulated as follows:
Hj,n= NX
i=1Pj,n(i)logPj,n(i) (18)
where Pj,n(i)is the normalized value of the energy of each segment of the signal; i=0, 1,:::,N.
The value of Nis 50 in this article.
According to the calculated wavelet energy entropy of each node, the wavelet energy entropy
feature is formed by Equation (19):
T=[H3,1,H3,2,H3,3,H3,4,H3,5,H3,6,H3,7,H3,8] (19)
The fault features obtained above are fed into the Cos-LSTM network to diagnose the gearbox
fault. The Ô¨Çow chart of fault diagnosis based on the Cos-LSTM is shown in Figure 4.
------------------------------End of the page -----------------------------------
Sensors 2020 ,20, 2339 7 of 13
Sensors 2020 , 20, x FOR PEER REVIEW 7 of 13 
 Vibration 
signal 1
Vibration 
signal 2WPD
 Signal collection
LSTM cell ...
x(0) x(1) x(2) x(7)h(0) h(1) h(2) h(7)
Input 
layerLSTM 
hidden 
layer
Fully connected 
layerh(7)......
Cosine loss 
layerClassification 
output layer0
1
2
3
100
1
2
3
10
Trained by cosine loss function
Wavelet energy 
entropy  
LSTM cell LSTM cell LSTM cellEnergy sequences 
feature
 
Figure 4. The flow chart of the Cos-LSTM me thod for gearbox fault diagnosis. 
We used one LSTM hidden layer with eight LSTM cells to extract deeper features. The fault 
features are first normalized and then fed into the input layer. In this paper, we used N samples ( N = 
2200 samples) to train the model. Therefore, the size of the input layer is N √ó 8 (time steps) √ó2 (2-
dimensional features), and the input size of each LSTM cell is N √ó 2. The last output h (7) of the LSTM 
hidden layer connects a fully connected layer with 11  neurons, using cosine loss to calculate the 
probabilities for the 11-fault pattern. 
The parameters of the LSTM neural network are pr esented as follows: time steps for LSTM = 8; 
the LSTM hidden layer neurons = 4; the fully conn ected layer neurons = 11; learning rate = 0.01; 
number of iterations of training = 10,000. The workflow of the Cos-LSTM is shown in Figure 5. 
Step 1:Data acquisition
Step 2:Feature extraction
Step 3:Model establishingThe Energy Sequence Feature
Cosine loss
 LSTM
Cos-LSTM Fault 1
Fault 2
...
Training
Step 4:Fault identificiation
 Diagnostic results Fault label
 
Figure 5. The workflow of the Cos-LSTM. 
Figure 4. The Ô¨Çow chart of the Cos-LSTM method for gearbox fault diagnosis.
We used one LSTM hidden layer with eight LSTM cells to extract deeper features. The fault
features are Ô¨Årst normalized and then fed into the input layer. In this paper, we used Nsamples
(N=2200 samples ) to train the model. Therefore, the size of the input layer is N8 (time steps)2
(2-dimensional features), and the input size of each LSTM cell is N2. The last output h(7) of the
LSTM hidden layer connects a fully connected layer with 11 neurons, using cosine loss to calculate the
probabilities for the 11-fault pattern.
The parameters of the LSTM neural network are presented as follows: time steps for LSTM =8;
the LSTM hidden layer neurons =4; the fully connected layer neurons =11; learning rate =0.01;
number of iterations of training =10,000. The workÔ¨Çow of the Cos-LSTM is shown in Figure 5.
Sensors 2020 , 20, x FOR PEER REVIEW 7 of 13 
 Vibration 
signal 1
Vibration 
signal 2WPD
 Signal collection
LSTM cell ...
x(0) x(1) x(2) x(7)h(0) h(1) h(2) h(7)
Input 
layerLSTM 
hidden 
layer
Fully connected 
layerh(7)......
Cosine loss 
layerClassification 
output layer0
1
2
3
100
1
2
3
10
Trained by cosine loss function
Wavelet energy 
entropy  
LSTM cell LSTM cell LSTM cellEnergy sequences 
feature
 
Figure 4. The flow chart of the Cos-LSTM me thod for gearbox fault diagnosis. 
We used one LSTM hidden layer with eight LSTM cells to extract deeper features. The fault 
features are first normalized and then fed into the input layer. In this paper, we used N samples ( N = 
2200 samples) to train the model. Therefore, the size of the input layer is N √ó 8 (time steps) √ó2 (2-
dimensional features), and the input size of each LSTM cell is N √ó 2. The last output h (7) of the LSTM 
hidden layer connects a fully connected layer with 11  neurons, using cosine loss to calculate the 
probabilities for the 11-fault pattern. 
The parameters of the LSTM neural network are pr esented as follows: time steps for LSTM = 8; 
the LSTM hidden layer neurons = 4; the fully conn ected layer neurons = 11; learning rate = 0.01; 
number of iterations of training = 10,000. The workflow of the Cos-LSTM is shown in Figure 5. 
Step 1:Data acquisition
Step 2:Feature extraction
Step 3:Model establishingThe Energy Sequence Feature
Cosine loss
 LSTM
Cos-LSTM Fault 1
Fault 2
...
Training
Step 4:Fault identificiation
 Diagnostic results Fault label
 
Figure 5. The workflow of the Cos-LSTM. 
Figure 5. The workÔ¨Çow of the Cos-LSTM.
------------------------------End of the page -----------------------------------
Sensors 2020 ,20, 2339 8 of 13
4. Experimental Validation
4.1. Experiment Description
The experimental test rig is illustrated in Figure 6a,b. The motor was controlled by an inverter
and connected to the input shaft of the gearbox to transmit power by a coupling. An electromagnetic
torque load was coupled with the output shaft of the gearbox through a V-belt. The electromagnetic
torque load was controlled by a torque controller (TDK-Lambda, GEN 100-15-IS510; TDK-Lambda,
Wuxi, China), which can adjust the torque of the load manually. Two accelerometers were mounted on
the gearbox to collect signals, and the signals collected were transmitted to a laptop using the data
acquisition card. Detailed information on the data acquisition system is provided in Table 1.
Table 1. Data acquisition settings.
Item Parameter
Sensor PCB ICP 353C03 accelerometer
Data acquisition box
SoftwareNI cDAQ-9234
LabVIEW
Sampling rate 50 kHz
Sensors 2020 , 20, x FOR PEER REVIEW 8 of 13 
 4. Experimental Validation 
4.1. Experiment Description 
The experimental test rig is illustrated in Figu re 6a,b. The motor was controlled by an inverter 
and connected to the input shaft of the gearbox to transmit power by a coupling. An electromagnetic torque load was coupled with the output shaft of the gearbox through a V-belt. The electromagnetic torque load was controlled by a torque controller (TDK-Lambda, GEN 100-15-IS510; TDK-Lambda, Wuxi, China), which can adjust the torque of the load manually. Two accelerometers were mounted 
on the gearbox to collect signals, and the signals co llected were transmitted to a laptop using the data 
acquisition card. Detailed information on the data  acquisition system is provided in Table 1. 
Table 1. Data acquisition settings. 
Item Parameter 
Sensor PCB ICP 353C03 accelerometer 
Data acquisition box 
Software NI cDAQ-9234 
LabVIEW 
Sampling rate 50 kHz 
 
  
(a) ( b) 
Figure 6. (a) Experimental test rig and ( b) the structure of the gearbox. 
The structure of the gearbox is displayed in Figure 6b. It consists of four gears, six bearings and 
three shafts. Shaft 1 was the input shaft, and gear Z1 , with a module of 2.25 mm, a pressure angle of 
20, a helical angle of 20, and 30 teeth, was installed on it. Shaft 1 transmitted the power to shaft 2 by a pair of gears (Z1 and Z2) in mesh. The output shaft (shaft 3) was driven by another helical gear Z4, with 80 teeth, which was meshed with the gear Z3. The helical gears Z2 and Z3 installed on shaft 2 both have 45 teeth and other parameters of them are the same to Z1. We installed one of the faulty components: bearing 1, bearing house 1, and gears Z1, Z2, Z3, Z4 every time on the gearbox to 
experiment. Table 2 shows all the condition patterns of the gearbox. 
Table 2. Condition patterns of the gearbox. 
Pattern 
Number Faulty 
Component Faulty Name Input Speed 
(rpm) Load(V) View of the 
Failure 
1 N/A N/A 480, 720, 900  0, 10, 30 N/A 
2 Gear Z1 Worn tooth 480, 720, 900  0, 10, 30 
 
3 Gear  Z2 Chafing tooth 480, 720, 900  0, 10, 30 
 
Figure 6. (a) Experimental test rig and ( b) the structure of the gearbox.
The structure of the gearbox is displayed in Figure 6b. It consists of four gears, six bearings and
three shafts. Shaft 1 was the input shaft, and gear Z1, with a module of 2.25 mm, a pressure angle
of 20, a helical angle of 20, and 30 teeth, was installed on it. Shaft 1 transmitted the power to shaft
2 by a pair of gears (Z1 and Z2) in mesh. The output shaft (shaft 3) was driven by another helical
gear Z4, with 80 teeth , which was meshed with the gear Z3. The helical gears Z2 and Z3 installed on
shaft 2 both have 45 teeth and other parameters of them are the same to Z1. We installed one of the
faulty components: bearing 1, bearing house 1, and gears Z1, Z2, Z3, Z4 every time on the gearbox to
experiment. Table 2 shows all the condition patterns of the gearbox.
------------------------------End of the page -----------------------------------
Sensors 2020 ,20, 2339 9 of 13
Table 2. Condition patterns of the gearbox.
Pattern
NumberFaulty
ComponentFaulty NameInput Speed
(rpm)Load (V)View of the
Failure
1 N /A N /A 480, 720, 900 0, 10, 30 N /A
2 Gear Z1 Worn tooth 480, 720, 900 0, 10, 30
Sensors 2020 , 20, x FOR PEER REVIEW 8 of 13 
 4. Experimental Validation 
4.1. Experiment Description 
The experimental test rig is illustrated in Figu re 6a,b. The motor was controlled by an inverter 
and connected to the input shaft of the gearbox to transmit power by a coupling. An electromagnetic torque load was coupled with the output shaft of the gearbox through a V-belt. The electromagnetic torque load was controlled by a torque controller (TDK-Lambda, GEN 100-15-IS510; TDK-Lambda, Wuxi, China), which can adjust the torque of the load manually. Two accelerometers were mounted 
on the gearbox to collect signals, and the signals co llected were transmitted to a laptop using the data 
acquisition card. Detailed information on the data  acquisition system is provided in Table 1. 
Table 1. Data acquisition settings. 
Item Parameter 
Sensor PCB ICP 353C03 accelerometer 
Data acquisition box 
Software NI cDAQ-9234 
LabVIEW 
Sampling rate 50 kHz 
 
  
(a) ( b) 
Figure 6. (a) Experimental test rig and ( b) the structure of the gearbox. 
The structure of the gearbox is displayed in Figure 6b. It consists of four gears, six bearings and 
three shafts. Shaft 1 was the input shaft, and gear Z1 , with a module of 2.25 mm, a pressure angle of 
20, a helical angle of 20, and 30 teeth, was installed on it. Shaft 1 transmitted the power to shaft 2 by a pair of gears (Z1 and Z2) in mesh. The output shaft (shaft 3) was driven by another helical gear Z4, with 80 teeth, which was meshed with the gear Z3. The helical gears Z2 and Z3 installed on shaft 2 both have 45 teeth and other parameters of them are the same to Z1. We installed one of the faulty components: bearing 1, bearing house 1, and gears Z1, Z2, Z3, Z4 every time on the gearbox to 
experiment. Table 2 shows all the condition patterns of the gearbox. 
Table 2. Condition patterns of the gearbox. 
Pattern 
Number Faulty 
Component Faulty Name Input Speed 
(rpm) Load(V) View of the 
Failure 
1 N/A N/A 480, 720, 900  0, 10, 30 N/A 
2 Gear Z1 Worn tooth 480, 720, 900  0, 10, 30 
 
3 Gear  Z2 Chafing tooth 480, 720, 900  0, 10, 30 
 
3 Gear Z2 ChaÔ¨Ång tooth 480, 720, 900 0, 10, 30
Sensors 2020 , 20, x FOR PEER REVIEW 8 of 13 
 4. Experimental Validation 
4.1. Experiment Description 
The experimental test rig is illustrated in Figu re 6a,b. The motor was controlled by an inverter 
and connected to the input shaft of the gearbox to transmit power by a coupling. An electromagnetic torque load was coupled with the output shaft of the gearbox through a V-belt. The electromagnetic torque load was controlled by a torque controller (TDK-Lambda, GEN 100-15-IS510; TDK-Lambda, Wuxi, China), which can adjust the torque of the load manually. Two accelerometers were mounted 
on the gearbox to collect signals, and the signals co llected were transmitted to a laptop using the data 
acquisition card. Detailed information on the data  acquisition system is provided in Table 1. 
Table 1. Data acquisition settings. 
Item Parameter 
Sensor PCB ICP 353C03 accelerometer 
Data acquisition box 
Software NI cDAQ-9234 
LabVIEW 
Sampling rate 50 kHz 
 
  
(a) ( b) 
Figure 6. (a) Experimental test rig and ( b) the structure of the gearbox. 
The structure of the gearbox is displayed in Figure 6b. It consists of four gears, six bearings and 
three shafts. Shaft 1 was the input shaft, and gear Z1 , with a module of 2.25 mm, a pressure angle of 
20, a helical angle of 20, and 30 teeth, was installed on it. Shaft 1 transmitted the power to shaft 2 by a pair of gears (Z1 and Z2) in mesh. The output shaft (shaft 3) was driven by another helical gear Z4, with 80 teeth, which was meshed with the gear Z3. The helical gears Z2 and Z3 installed on shaft 2 both have 45 teeth and other parameters of them are the same to Z1. We installed one of the faulty components: bearing 1, bearing house 1, and gears Z1, Z2, Z3, Z4 every time on the gearbox to 
experiment. Table 2 shows all the condition patterns of the gearbox. 
Table 2. Condition patterns of the gearbox. 
Pattern 
Number Faulty 
Component Faulty Name Input Speed 
(rpm) Load(V) View of the 
Failure 
1 N/A N/A 480, 720, 900  0, 10, 30 N/A 
2 Gear Z1 Worn tooth 480, 720, 900  0, 10, 30 
 
3 Gear  Z2 Chafing tooth 480, 720, 900  0, 10, 30 
 
4 Gear Z3 Pitting tooth 480, 720, 900 0, 10, 30
Sensors 2020 , 20, x FOR PEER REVIEW 9 of 13 
 4 Gear  Z3 Pitting tooth 480, 720, 900  0, 10, 30 
 
5 Gear  Z3 Worn tooth 480, 720, 900  0, 10 30 
 
6 Gear  Z4 Root crack 
tooth 480, 720, 900  0, 10, 30 
 
7 Gear  Z4 Chafing tooth 480, 720, 900  0, 10, 30 
 
8 Bearing 1 Inner race fault 480, 720, 900  0, 10, 30 
 
9 Bearing 1 Outer race 
fault 480, 720, 900  0, 10, 30 
 
10 Bearing 1 Ball fault 480, 720, 900  0, 10, 30 
 
11 House 1 Eccentric 480, 720, 900  0, 10, 30 
 
4.2. Experimental Results 
Firstly, we verified the Cos-LSTM with the ener gy sequence features. We chose a test sample for 
explanation of the fault diagnosi s process of our proposed method . The pattern number of this 
sample is 3 (chafing tooth), and the input speed and load of this sample are set to 480 rpm and zero respectively. The raw vibration signals and energy dist ribution map is shown in Figure 7. Figure 7a,c 
presents the raw signals  ùë†
‡Ø©‡¨µ (ùë°),ùë†‡Ø©‡¨∂ (ùë°) of this sample collected on the gearbox and Figure 7b,d 
presents their energy distribution maps of the third layer WPD ùëÉ‡Ø©‡¨µ and ùëÉ‡Ø©‡¨∂. Putting the energy 
sequences feature of this sample into the Cos-LSTM , we got the probability of each fault pattern for 
the sample. The probability of the no. 3 fault pattern is 99.97% and the other 10 faults have a probability of 0.03%. The result shows that our proposed method considers that there is a fault numbered 3 (chafing tooth) in the gearbox. The result is correct for this test sample, so the method we proposed is effective. 
  
(a) ( b) 
  
(c) ( d) 
Vibration signal 1
12345678
Frequency bands020406080100
5 Gear Z3 Worn tooth 480, 720, 900 0, 10 30
Sensors 2020 , 20, x FOR PEER REVIEW 9 of 13 
 4 Gear  Z3 Pitting tooth 480, 720, 900  0, 10, 30 
 
5 Gear  Z3 Worn tooth 480, 720, 900  0, 10 30 
 
6 Gear  Z4 Root crack 
tooth 480, 720, 900  0, 10, 30 
 
7 Gear  Z4 Chafing tooth 480, 720, 900  0, 10, 30 
 
8 Bearing 1 Inner race fault 480, 720, 900  0, 10, 30 
 
9 Bearing 1 Outer race 
fault 480, 720, 900  0, 10, 30 
 
10 Bearing 1 Ball fault 480, 720, 900  0, 10, 30 
 
11 House 1 Eccentric 480, 720, 900  0, 10, 30 
 
4.2. Experimental Results 
Firstly, we verified the Cos-LSTM with the ener gy sequence features. We chose a test sample for 
explanation of the fault diagnosi s process of our proposed method . The pattern number of this 
sample is 3 (chafing tooth), and the input speed and load of this sample are set to 480 rpm and zero respectively. The raw vibration signals and energy dist ribution map is shown in Figure 7. Figure 7a,c 
presents the raw signals  ùë†
‡Ø©‡¨µ (ùë°),ùë†‡Ø©‡¨∂ (ùë°) of this sample collected on the gearbox and Figure 7b,d 
presents their energy distribution maps of the third layer WPD ùëÉ‡Ø©‡¨µ and ùëÉ‡Ø©‡¨∂. Putting the energy 
sequences feature of this sample into the Cos-LSTM , we got the probability of each fault pattern for 
the sample. The probability of the no. 3 fault pattern is 99.97% and the other 10 faults have a probability of 0.03%. The result shows that our proposed method considers that there is a fault numbered 3 (chafing tooth) in the gearbox. The result is correct for this test sample, so the method we proposed is effective. 
  
(a) ( b) 
  
(c) ( d) 
Vibration signal 1
12345678
Frequency bands020406080100
6 Gear Z4 Root crack tooth 480, 720, 900 0, 10, 30
Sensors 2020 , 20, x FOR PEER REVIEW 9 of 13 
 4 Gear  Z3 Pitting tooth 480, 720, 900  0, 10, 30 
 
5 Gear  Z3 Worn tooth 480, 720, 900  0, 10 30 
 
6 Gear  Z4 Root crack 
tooth 480, 720, 900  0, 10, 30 
 
7 Gear  Z4 Chafing tooth 480, 720, 900  0, 10, 30 
 
8 Bearing 1 Inner race fault 480, 720, 900  0, 10, 30 
 
9 Bearing 1 Outer race 
fault 480, 720, 900  0, 10, 30 
 
10 Bearing 1 Ball fault 480, 720, 900  0, 10, 30 
 
11 House 1 Eccentric 480, 720, 900  0, 10, 30 
 
4.2. Experimental Results 
Firstly, we verified the Cos-LSTM with the ener gy sequence features. We chose a test sample for 
explanation of the fault diagnosi s process of our proposed method . The pattern number of this 
sample is 3 (chafing tooth), and the input speed and load of this sample are set to 480 rpm and zero respectively. The raw vibration signals and energy dist ribution map is shown in Figure 7. Figure 7a,c 
presents the raw signals  ùë†
‡Ø©‡¨µ (ùë°),ùë†‡Ø©‡¨∂ (ùë°) of this sample collected on the gearbox and Figure 7b,d 
presents their energy distribution maps of the third layer WPD ùëÉ‡Ø©‡¨µ and ùëÉ‡Ø©‡¨∂. Putting the energy 
sequences feature of this sample into the Cos-LSTM , we got the probability of each fault pattern for 
the sample. The probability of the no. 3 fault pattern is 99.97% and the other 10 faults have a probability of 0.03%. The result shows that our proposed method considers that there is a fault numbered 3 (chafing tooth) in the gearbox. The result is correct for this test sample, so the method we proposed is effective. 
  
(a) ( b) 
  
(c) ( d) 
Vibration signal 1
12345678
Frequency bands020406080100
7 Gear Z4 ChaÔ¨Ång tooth 480, 720, 900 0, 10, 30
Sensors 2020 , 20, x FOR PEER REVIEW 9 of 13 
 4 Gear  Z3 Pitting tooth 480, 720, 900  0, 10, 30 
 
5 Gear  Z3 Worn tooth 480, 720, 900  0, 10 30 
 
6 Gear  Z4 Root crack 
tooth 480, 720, 900  0, 10, 30 
 
7 Gear  Z4 Chafing tooth 480, 720, 900  0, 10, 30 
 
8 Bearing 1 Inner race fault 480, 720, 900  0, 10, 30 
 
9 Bearing 1 Outer race 
fault 480, 720, 900  0, 10, 30 
 
10 Bearing 1 Ball fault 480, 720, 900  0, 10, 30 
 
11 House 1 Eccentric 480, 720, 900  0, 10, 30 
 
4.2. Experimental Results 
Firstly, we verified the Cos-LSTM with the ener gy sequence features. We chose a test sample for 
explanation of the fault diagnosi s process of our proposed method . The pattern number of this 
sample is 3 (chafing tooth), and the input speed and load of this sample are set to 480 rpm and zero respectively. The raw vibration signals and energy dist ribution map is shown in Figure 7. Figure 7a,c 
presents the raw signals  ùë†
‡Ø©‡¨µ (ùë°),ùë†‡Ø©‡¨∂ (ùë°) of this sample collected on the gearbox and Figure 7b,d 
presents their energy distribution maps of the third layer WPD ùëÉ‡Ø©‡¨µ and ùëÉ‡Ø©‡¨∂. Putting the energy 
sequences feature of this sample into the Cos-LSTM , we got the probability of each fault pattern for 
the sample. The probability of the no. 3 fault pattern is 99.97% and the other 10 faults have a probability of 0.03%. The result shows that our proposed method considers that there is a fault numbered 3 (chafing tooth) in the gearbox. The result is correct for this test sample, so the method we proposed is effective. 
  
(a) ( b) 
  
(c) ( d) 
Vibration signal 1
12345678
Frequency bands020406080100
8 Bearing 1 Inner race fault 480, 720, 900 0, 10, 30
Sensors 2020 , 20, x FOR PEER REVIEW 9 of 13 
 4 Gear  Z3 Pitting tooth 480, 720, 900  0, 10, 30 
 
5 Gear  Z3 Worn tooth 480, 720, 900  0, 10 30 
 
6 Gear  Z4 Root crack 
tooth 480, 720, 900  0, 10, 30 
 
7 Gear  Z4 Chafing tooth 480, 720, 900  0, 10, 30 
 
8 Bearing 1 Inner race fault 480, 720, 900  0, 10, 30 
 
9 Bearing 1 Outer race 
fault 480, 720, 900  0, 10, 30 
 
10 Bearing 1 Ball fault 480, 720, 900  0, 10, 30 
 
11 House 1 Eccentric 480, 720, 900  0, 10, 30 
 
4.2. Experimental Results 
Firstly, we verified the Cos-LSTM with the ener gy sequence features. We chose a test sample for 
explanation of the fault diagnosi s process of our proposed method . The pattern number of this 
sample is 3 (chafing tooth), and the input speed and load of this sample are set to 480 rpm and zero respectively. The raw vibration signals and energy dist ribution map is shown in Figure 7. Figure 7a,c 
presents the raw signals  ùë†
‡Ø©‡¨µ (ùë°),ùë†‡Ø©‡¨∂ (ùë°) of this sample collected on the gearbox and Figure 7b,d 
presents their energy distribution maps of the third layer WPD ùëÉ‡Ø©‡¨µ and ùëÉ‡Ø©‡¨∂. Putting the energy 
sequences feature of this sample into the Cos-LSTM , we got the probability of each fault pattern for 
the sample. The probability of the no. 3 fault pattern is 99.97% and the other 10 faults have a probability of 0.03%. The result shows that our proposed method considers that there is a fault numbered 3 (chafing tooth) in the gearbox. The result is correct for this test sample, so the method we proposed is effective. 
  
(a) ( b) 
  
(c) ( d) 
Vibration signal 1
12345678
Frequency bands020406080100
9 Bearing 1 Outer race fault 480, 720, 900 0, 10, 30
Sensors 2020 , 20, x FOR PEER REVIEW 9 of 13 
 4 Gear  Z3 Pitting tooth 480, 720, 900  0, 10, 30 
 
5 Gear  Z3 Worn tooth 480, 720, 900  0, 10 30 
 
6 Gear  Z4 Root crack 
tooth 480, 720, 900  0, 10, 30 
 
7 Gear  Z4 Chafing tooth 480, 720, 900  0, 10, 30 
 
8 Bearing 1 Inner race fault 480, 720, 900  0, 10, 30 
 
9 Bearing 1 Outer race 
fault 480, 720, 900  0, 10, 30 
 
10 Bearing 1 Ball fault 480, 720, 900  0, 10, 30 
 
11 House 1 Eccentric 480, 720, 900  0, 10, 30 
 
4.2. Experimental Results 
Firstly, we verified the Cos-LSTM with the ener gy sequence features. We chose a test sample for 
explanation of the fault diagnosi s process of our proposed method . The pattern number of this 
sample is 3 (chafing tooth), and the input speed and load of this sample are set to 480 rpm and zero respectively. The raw vibration signals and energy dist ribution map is shown in Figure 7. Figure 7a,c 
presents the raw signals  ùë†
‡Ø©‡¨µ (ùë°),ùë†‡Ø©‡¨∂ (ùë°) of this sample collected on the gearbox and Figure 7b,d 
presents their energy distribution maps of the third layer WPD ùëÉ‡Ø©‡¨µ and ùëÉ‡Ø©‡¨∂. Putting the energy 
sequences feature of this sample into the Cos-LSTM , we got the probability of each fault pattern for 
the sample. The probability of the no. 3 fault pattern is 99.97% and the other 10 faults have a probability of 0.03%. The result shows that our proposed method considers that there is a fault numbered 3 (chafing tooth) in the gearbox. The result is correct for this test sample, so the method we proposed is effective. 
  
(a) ( b) 
  
(c) ( d) 
Vibration signal 1
12345678
Frequency bands020406080100
10 Bearing 1 Ball fault 480, 720, 900 0, 10, 30
Sensors 2020 , 20, x FOR PEER REVIEW 9 of 13 
 4 Gear  Z3 Pitting tooth 480, 720, 900  0, 10, 30 
 
5 Gear  Z3 Worn tooth 480, 720, 900  0, 10 30 
 
6 Gear  Z4 Root crack 
tooth 480, 720, 900  0, 10, 30 
 
7 Gear  Z4 Chafing tooth 480, 720, 900  0, 10, 30 
 
8 Bearing 1 Inner race fault 480, 720, 900  0, 10, 30 
 
9 Bearing 1 Outer race 
fault 480, 720, 900  0, 10, 30 
 
10 Bearing 1 Ball fault 480, 720, 900  0, 10, 30 
 
11 House 1 Eccentric 480, 720, 900  0, 10, 30 
 
4.2. Experimental Results 
Firstly, we verified the Cos-LSTM with the ener gy sequence features. We chose a test sample for 
explanation of the fault diagnosi s process of our proposed method . The pattern number of this 
sample is 3 (chafing tooth), and the input speed and load of this sample are set to 480 rpm and zero respectively. The raw vibration signals and energy dist ribution map is shown in Figure 7. Figure 7a,c 
presents the raw signals  ùë†
‡Ø©‡¨µ (ùë°),ùë†‡Ø©‡¨∂ (ùë°) of this sample collected on the gearbox and Figure 7b,d 
presents their energy distribution maps of the third layer WPD ùëÉ‡Ø©‡¨µ and ùëÉ‡Ø©‡¨∂. Putting the energy 
sequences feature of this sample into the Cos-LSTM , we got the probability of each fault pattern for 
the sample. The probability of the no. 3 fault pattern is 99.97% and the other 10 faults have a probability of 0.03%. The result shows that our proposed method considers that there is a fault numbered 3 (chafing tooth) in the gearbox. The result is correct for this test sample, so the method we proposed is effective. 
  
(a) ( b) 
  
(c) ( d) 
Vibration signal 1
12345678
Frequency bands020406080100
11 House 1 Eccentric 480, 720, 900 0, 10, 30
Sensors 2020 , 20, x FOR PEER REVIEW 9 of 13 
 4 Gear  Z3 Pitting tooth 480, 720, 900  0, 10, 30 
 
5 Gear  Z3 Worn tooth 480, 720, 900  0, 10 30 
 
6 Gear  Z4 Root crack 
tooth 480, 720, 900  0, 10, 30 
 
7 Gear  Z4 Chafing tooth 480, 720, 900  0, 10, 30 
 
8 Bearing 1 Inner race fault 480, 720, 900  0, 10, 30 
 
9 Bearing 1 Outer race 
fault 480, 720, 900  0, 10, 30 
 
10 Bearing 1 Ball fault 480, 720, 900  0, 10, 30 
 
11 House 1 Eccentric 480, 720, 900  0, 10, 30 
 
4.2. Experimental Results 
Firstly, we verified the Cos-LSTM with the ener gy sequence features. We chose a test sample for 
explanation of the fault diagnosi s process of our proposed method . The pattern number of this 
sample is 3 (chafing tooth), and the input speed and load of this sample are set to 480 rpm and zero respectively. The raw vibration signals and energy dist ribution map is shown in Figure 7. Figure 7a,c 
presents the raw signals  ùë†
‡Ø©‡¨µ (ùë°),ùë†‡Ø©‡¨∂ (ùë°) of this sample collected on the gearbox and Figure 7b,d 
presents their energy distribution maps of the third layer WPD ùëÉ‡Ø©‡¨µ and ùëÉ‡Ø©‡¨∂. Putting the energy 
sequences feature of this sample into the Cos-LSTM , we got the probability of each fault pattern for 
the sample. The probability of the no. 3 fault pattern is 99.97% and the other 10 faults have a probability of 0.03%. The result shows that our proposed method considers that there is a fault numbered 3 (chafing tooth) in the gearbox. The result is correct for this test sample, so the method we proposed is effective. 
  
(a) ( b) 
  
(c) ( d) 
Vibration signal 1
12345678
Frequency bands020406080100
4.2. Experimental Results
Firstly, we veriÔ¨Åed the Cos-LSTM with the energy sequence features. We chose a test sample for
explanation of the fault diagnosis process of our proposed method. The pattern number of this sample
is 3 (chaÔ¨Ång tooth), and the input speed and load of this sample are set to 480 rpm and zero respectively.
The raw vibration signals and energy distribution map is shown in Figure 7. Figure 7a,c presents the
raw signals sv1(t),sv2(t)of this sample collected on the gearbox and Figure 7b,d presents their energy
distribution maps of the third layer WPD Pv1and Pv2. Putting the energy sequences feature of this
sample into the Cos-LSTM, we got the probability of each fault pattern for the sample. The probability
of the no. 3 fault pattern is 99.97% and the other 10 faults have a probability of 0.03%. The result shows
that our proposed method considers that there is a fault numbered 3 (chaÔ¨Ång tooth) in the gearbox.
The result is correct for this test sample, so the method we proposed is e ective.
------------------------------End of the page -----------------------------------
Sensors 2020 ,20, 2339 10 of 13
Sensors 2020 , 20, x FOR PEER REVIEW 9 of 13 
 4 Gear  Z3 Pitting tooth 480, 720, 900  0, 10, 30 
 
5 Gear  Z3 Worn tooth 480, 720, 900  0, 10 30 
 
6 Gear  Z4 Root crack 
tooth 480, 720, 900  0, 10, 30 
 
7 Gear  Z4 Chafing tooth 480, 720, 900  0, 10, 30 
 
8 Bearing 1 Inner race fault 480, 720, 900  0, 10, 30 
 
9 Bearing 1 Outer race 
fault 480, 720, 900  0, 10, 30 
 
10 Bearing 1 Ball fault 480, 720, 900  0, 10, 30 
 
11 House 1 Eccentric 480, 720, 900  0, 10, 30 
 
4.2. Experimental Results 
Firstly, we verified the Cos-LSTM with the ener gy sequence features. We chose a test sample for 
explanation of the fault diagnosi s process of our proposed method . The pattern number of this 
sample is 3 (chafing tooth), and the input speed and load of this sample are set to 480 rpm and zero respectively. The raw vibration signals and energy dist ribution map is shown in Figure 7. Figure 7a,c 
presents the raw signals  ùë†
‡Ø©‡¨µ (ùë°),ùë†‡Ø©‡¨∂ (ùë°) of this sample collected on the gearbox and Figure 7b,d 
presents their energy distribution maps of the third layer WPD ùëÉ‡Ø©‡¨µ and ùëÉ‡Ø©‡¨∂. Putting the energy 
sequences feature of this sample into the Cos-LSTM , we got the probability of each fault pattern for 
the sample. The probability of the no. 3 fault pattern is 99.97% and the other 10 faults have a probability of 0.03%. The result shows that our proposed method considers that there is a fault numbered 3 (chafing tooth) in the gearbox. The result is correct for this test sample, so the method we proposed is effective. 
  
(a) ( b) 
  
(c) ( d) 
Vibration signal 1
12345678
Frequency bands020406080100
Figure 7. The raw vibration signals and energy distribution map.
From Table 2, it can be seen that three di erent input speeds and loads are set for all 11 fault
patterns. Therefore, we have a total of 99 di erent tests, and each test is repeated Ô¨Åve times. In each
test, the signals are collected with 10 durations, and every duration covers 1 s. Therefore, we can
get 9900 vibration signals. In order to train the model, we randomly choose 2200 samples as the
training dataset. With the trained model, another 550 randomly chosen samples are used to test the
eectiveness of the model. The e ectiveness is measured by the accuracy rate. In this experiment, the
accuracy rate is the number of correctly diagnosed samples divided by all the test samples, and the
precision is the ratio of the number of samples correctly diagnosed with a fault pattern to the total
number of samples diagnosed with such a fault pattern. The accuracy rate of the model is 98.55% in
550 samples. The accuracy rates and precision of our proposed model for the 11 fault patterns are
shown in Figures 8 and 9 respectively.
Sensors 2020 , 20, x FOR PEER REVIEW 10 of 13 
 Figure 7. The raw vibration signals and energy distribution map. 
From Table 2, it can be seen that three differ ent input speeds and loads are set for all 11 fault 
patterns. Therefore, we have a total of 99 different tests, and each test is repeated five times. In each test, the signals are collected with 10 durations, and every duration covers 1 s. Therefore, we can get 
9900 vibration signals. In order to train the mode l, we randomly choose 2200 samples as the training 
dataset. With the trained model, another 550 ra ndomly chosen samples are used to test the 
effectiveness of the model. The effectiveness is meas ured by the accuracy rate. In this experiment, the 
accuracy rate is the number of correctly diagnosed samples divided by all the test samples, and the 
precision is the ratio of the number of samples co rrectly diagnosed with a fault pattern to the total 
number of samples diagnosed with such a fault patter n. The accuracy rate of the model is 98.55% in 
550 samples. The accuracy rates and precision of  our proposed model for the 11 fault patterns are 
shown in Figure 8 and Figure 9 respectively. 
 
Figure 8. The accuracy rates for the 11 fault patterns. 
 
Figure 9. The precision for the 11 fault patterns. 
4.3. Comparison Analysis 
In this paper, the energy sequence features were used to verify the superiority of the Cos-LSTM 
by comparing with the traditional LSTM based on softmax loss and classic fault diagnosis methods, such as SVM, K-nearest neighbor (KNN) and back propagation (BP) neural networks. In order to 
better evaluate the accuracy of the Cos-LSTM, we also used wavelet energy entropy feature for the 
fault diagnosis test. Table 3 shows the comparison results. Meanwhile, the different energy sequence 
features were extracted by changing the parameters of WPD such as wavelet basis function and data segment size, for evaluating the accuracy of the Co s-LSTM, and the results ar e displayed in Table 4. 
Table 3. Comparisons with other classic fault diagnosis methods. 
Feature Fault Diagnosis 
Methods  Accuracy 
Rate 
Figure 8. The accuracy rates for the 11 fault patterns.
------------------------------End of the page -----------------------------------
Sensors 2020 ,20, 2339 11 of 13
Sensors 2020 , 20, x FOR PEER REVIEW 10 of 13 
 Figure 7. The raw vibration signals and energy distribution map. 
From Table 2, it can be seen that three differ ent input speeds and loads are set for all 11 fault 
patterns. Therefore, we have a total of 99 different tests, and each test is repeated five times. In each test, the signals are collected with 10 durations, and every duration covers 1 s. Therefore, we can get 
9900 vibration signals. In order to train the mode l, we randomly choose 2200 samples as the training 
dataset. With the trained model, another 550 ra ndomly chosen samples are used to test the 
effectiveness of the model. The effectiveness is meas ured by the accuracy rate. In this experiment, the 
accuracy rate is the number of correctly diagnosed samples divided by all the test samples, and the 
precision is the ratio of the number of samples co rrectly diagnosed with a fault pattern to the total 
number of samples diagnosed with such a fault patter n. The accuracy rate of the model is 98.55% in 
550 samples. The accuracy rates and precision of  our proposed model for the 11 fault patterns are 
shown in Figure 8 and Figure 9 respectively. 
 
Figure 8. The accuracy rates for the 11 fault patterns. 
 
Figure 9. The precision for the 11 fault patterns. 
4.3. Comparison Analysis 
In this paper, the energy sequence features were used to verify the superiority of the Cos-LSTM 
by comparing with the traditional LSTM based on softmax loss and classic fault diagnosis methods, such as SVM, K-nearest neighbor (KNN) and back propagation (BP) neural networks. In order to 
better evaluate the accuracy of the Cos-LSTM, we also used wavelet energy entropy feature for the 
fault diagnosis test. Table 3 shows the comparison results. Meanwhile, the different energy sequence 
features were extracted by changing the parameters of WPD such as wavelet basis function and data segment size, for evaluating the accuracy of the Co s-LSTM, and the results ar e displayed in Table 4. 
Table 3. Comparisons with other classic fault diagnosis methods. 
Feature Fault Diagnosis 
Methods  Accuracy 
Rate 
Figure 9. The precision for the 11 fault patterns.
4.3. Comparison Analysis
In this paper, the energy sequence features were used to verify the superiority of the Cos-LSTM
by comparing with the traditional LSTM based on softmax loss and classic fault diagnosis methods,
such as SVM, K-nearest neighbor (KNN) and backpropagation (BP) neural networks. In order to
better evaluate the accuracy of the Cos-LSTM, we also used wavelet energy entropy feature for the
fault diagnosis test. Table 3 shows the comparison results. Meanwhile, the di erent energy sequence
features were extracted by changing the parameters of WPD such as wavelet basis function and data
segment size, for evaluating the accuracy of the Cos-LSTM, and the results are displayed in Table 4.
Table 3. Comparisons with other classic fault diagnosis methods.
Feature Fault Diagnosis Methods Accuracy Rate
The energy sequenceCos-LSTM 98.55%
LSTM 96.72%
SVM 65.48%
KNN 83.93%
BP neural network 69.64%
Wavelet Energy entropy Cos-LSTM 98.08%
Table 4. Comparisons with di erent parameter of WPD.
Item Parameter Accuracy Rate
Wavelet basis functionDaubechies 3 98.55%
Daubechies 2 96.36%
Haar 93.82%
Symlet 97.09%
Segment size2 96.63%
3 97.12%
4 98.55%
According to Tables 3 and 4, the Cos-LSTM has the highest accuracy rate (98.55%) compared to
other methods in the experimental results on the energy sequence features. After comparison and
analysis, it can be found that: (1) comparison with traditional LSTM shows that the classiÔ¨Åcation ability
of cosine loss is better than that of softmax loss; (2) the accuracy rate of the LSTM neural network
is better than KNN, SVM and BP neural networks, which indicates that the LSTM neural network
has better feature-learning ability compared to classic fault diagnosis methods; (3) the evaluation
results of Cos-LSTM using wavelet energy entropy are close to those using energy sequence features;
(4) the accuracy rate of the Cos-LSTM is inÔ¨Çuenced by the energy sequence features extracted with
dierent parameters of WPD, and the result shows that the energy sequence features extracted based
on the wavelet basis function of Daubechies 3 (db3) and segment size 4 have better diagnostic accuracy
------------------------------End of the page -----------------------------------
Sensors 2020 ,20, 2339 12 of 13
rates; and (5) combined with the experimental results of energy sequence features and wavelet energy
entropy, Cos-LSTM is able to diagnose the faults of the gearbox e ectively.
5. Conclusions
This paper presented a fault diagnosis method for WT gearboxes based on the optimized LSTM
network with cosine loss. The energy sequence features and the wavelet energy entropy were used to
evaluate the Cos-LSTM network. The e ectiveness of the Cos-LSTM was veriÔ¨Åed by a fault diagnosis
experiment on a gearbox. The classiÔ¨Åcation results show that the performance of the Cos-LSTM is
better than that of the traditional LSTM and classic fault diagnosis techniques. Thus, the proposed
method has superior performance in fault diagnosis. In the future, new studies will be conducted on
feature learning directly from raw vibration signals using LSTM neural networks.
Author Contributions: Data curation, C.L.; Methodology, A.Y. and Z.Z.; Project administration, A.Y.; Resources,
R.-V .S.; Supervision, A.Y.; Writing‚Äîoriginal draft, Y.Y.; Writing‚Äîreview & editing, Y.Y. and Z.Z. All authors have
read and agreed to the published version of the manuscript.
Funding: This work was supported by the Key Science and Technology Research Project of Chongqing under
grant cstc2018jszx-cyztzxX0032.
ConÔ¨Çicts of Interest: The authors declare no conÔ¨Çict of interest.
References
1. Zhao, X.; Yan, Z.; Zhang, X.-P . A Wind-Wave Farm System with Self-Energy Storage and Smoothed Power
Output. IEEE Access 2016 ,4, 8634‚Äì8642. [CrossRef]
2. Hu, A.; Yan, X.; Xiang, L. A new wind turbine fault diagnosis method based on ensemble intrinsic time-scale
decomposition and WPT-fractal dimension. Renew. Energy 2015 ,83, 767‚Äì778. [CrossRef]
3. Walford, C.A. Wind Turbine Reliability: Understanding and Minimizing Wind Turbine Operation and Maintenance
Costs ; Sandia National Laboratories: Albuquerque, NM, USA, 2006.
4. Jiang, G.; He, H.; Yan, J.; Xie, P . Multiscale Convolutional Neural Networks for Fault Diagnosis of Wind
Turbine Gearbox. IEEE Trans. Ind. Electron. 2019 ,66, 3196‚Äì3207. [CrossRef]
5. Feng, Z.; Qin, S.; Liang, M. Time-frequency analysis based on Vold-Kalman Ô¨Ålter and higher order energy
separation for fault diagnosis of wind turbine planetary gearbox under nonstationary conditions. Renew.
Energy 2016 ,85, 45‚Äì56. [CrossRef]
6. Zhang, Y.; Lu, W.; Chu, F. Planet gear fault localization for wind turbine gearbox using acoustic emission
signals. Renew. Energy 2017 ,109, 449‚Äì460. [CrossRef]
7. Bejger, A.; Chybowski, L.; Gawdzinska, K. Utilising elastic waves of acoustic emission to assess the condition
of spray nozzles in a marine diesel engine. J. Mar. Eng. Technol. 2018 ,17, 153‚Äì159. [CrossRef]
8. Bejger, A.; Drzewieniecki, J.B. The Use of Acoustic Emission to Diagnosis of Fuel Injection Pumps of Marine
Diesel Engines. Energies 2019 ,12. [CrossRef]
9. Jia, F.; Lei, Y.; Lin, J.; Zhou, X.; Lu, N. Deep neural networks: A promising tool for fault characteristic mining
and intelligent diagnosis of rotating machinery with massive data. Mech. Syst. Signal Process. 2016 ,72‚Äì73 ,
303‚Äì315. [CrossRef]
10. Lei, Y.; Jia, F.; Lin, J.; Xing, S.; Ding, S.X. An Intelligent Fault Diagnosis Method Using Unsupervised Feature
Learning Towards Mechanical Big Data. IEEE Trans. Ind. Electron. 2016 ,63, 3137‚Äì3147. [CrossRef]
11. Lei, Y.; He, Z.; Zi, Y.; Hu, Q. Fault diagnosis of rotating machinery based on multiple ANFIS combination
with GAS. Mech. Syst. Signal Process. 2007 ,21, 2280‚Äì2294. [CrossRef]
12. Wang, D.; Tse, P .W.; Guo, W.; Miao, Q. Support vector data description for fusion of multiple health indicators
for enhancing gearbox fault diagnosis and prognosis. Meas. Sci. Technol. 2011 ,22. [CrossRef]
13. Gao, Q.W.; Liu, W.Y.; Tang, B.P .; Li, G.J. A novel wind turbine fault diagnosis method based on intergral
extension load mean decomposition multiscale entropy and least squares support vector machine. Renew.
Energy 2018 ,116, 169‚Äì175. [CrossRef]
14. Santos, P .; Villa, L.F.; Renones, A.; Bustillo, A.; Maudes, J. An SVM-Based Solution for Fault Detection in
Wind Turbines. Sensors 2015 ,15, 5627‚Äì5648. [CrossRef]
------------------------------End of the page -----------------------------------
Sensors 2020 ,20, 2339 13 of 13
15. Abbasion, S.; Rafsanjani, A.; Farshidianfar, A.; Irani, N. Rolling element bearings multi-fault classiÔ¨Åcation
based on the wavelet denoising and support vector machine. Mech. Syst. Signal Process. 2007 ,21, 2933‚Äì2945.
[CrossRef]
16. Liu, W.Y.; Gao, Q.W.; Ye, G.; Ma, R.; Lu, X.N. A novel wind turbine bearing fault diagnosis method based on
Integral Extension LMD. Measurement 2015 ,74, 70‚Äì77. [CrossRef]
17. Lei, Y. Intelligent Fault Diagnosis and Remaining Useful Life Prediction of Rotating Machinery ; Xi‚Äôan Jiaotong
University Press: Xi‚Äôan, China, 2017.
18. Li, C.; Sanchez, R.-V .; Zurita, G.; Cerrada, M.; Cabrera, D. Fault Diagnosis for Rotating Machinery Using
Vibration Measurement Deep Statistical Feature Learning. Sensors 2016 ,16. [CrossRef]
19. Chen, Z.; Li, C.; Sanchez, R.-V . Gearbox Fault IdentiÔ¨Åcation and ClassiÔ¨Åcation with Convolutional Neural
Networks. Shock Vib. 2015 . [CrossRef]
20. An, Z.; Li, S.; Wang, J.; Jiang, X. A novel bearing intelligent fault diagnosis framework under time-varying
working conditions using recurrent neural network. ISA Trans. 2019 . [CrossRef]
21. Cao, L.; Zhang, J.; Wang, J.; Qian, Z. Intelligent fault diagnosis of wind turbine gearbox based on Long
short-term memory networks. In Proceedings of the 2019 IEEE 28th International Symposium on Industrial
Electronics, Vancouver, BC, Canada, 12‚Äì14 June 2019; pp. 890‚Äì895.
22. Medina, R.; Cerrada, M.; Cabrera, D.; Sanchez, R.-V .; Li, C.; de Oliveira, J.V . Deep Learning-Based Gear
Pitting Severity Assessment using Acoustic Emission, Vibration and Currents signals. In Proceedings of the
2019 Prognostics and System Health Management Conference, Paris, France, 2‚Äì5 May 2019; pp. 210‚Äì216.
23. Wang, H.; Wang, Y.; Zhou, Z.; Ji, X.; Gong, D.; Zhou, J.; Li, Z.; Liu, W. CosFace: Large Margin Cosine Loss for
Deep Face Recognition. In Proceedings of the 2018 IEEE /Cvf Conference on Computer Vision and Pattern
Recognition, Salt Lake City, UT, USA, 18‚Äì23 June 2018; pp. 5265‚Äì5274.
24. Hochreiter, S.; Schmidhuber, J. Long short-term memory. Neural Comput. 1997 ,9, 1735‚Äì1780. [CrossRef]
25. Graves, A. Supervised sequence labelling. In Supervised Sequence Labelling with Recurrent Neural Networks ;
Springer: Berlin /Heidelberg, Germany, 2012; pp. 5‚Äì13.
26. Wen, Y.; Zhang, K.; Li, Z.; Qiao, Y. A discriminative feature learning approach for deep face recognition.
Proceedings of European Conference on Computer Vision, Amsterdam, The Netherlands, 8‚Äì16 October 2016;
pp. 499‚Äì515.
27. Liu, W.; Wen, Y.; Yu, Z.; Li, M.; Raj, B.; Song, L. SphereFace: Deep Hypersphere Embedding for Face
Recognition. In Proceedings of the 30th IEEE Conference on Computer Vision and Pattern Recognition,
Honolulu, HI, USA, 21‚Äì26 July 2017; pp. 6738‚Äì6746.
28. Shao, Y.; Ge, L.; Fang, J. Fault diagnosis system based on smart bearing. In Proceedings of the 2008 International
Conference on Control, Automation and Systems, Seoul, Korea, 14‚Äì17 October 2008; pp. 1084‚Äì1089.
29. Kedadouche, M.; Liu, Z. Fault feature extraction and classiÔ¨Åcation based on WPT and SVD: Application to
element bearings with artiÔ¨Åcially created faults under variable conditions. Proc. Inst. Mech. Eng. Part C J.
Mech. Eng. Sci. 2017 ,231, 4186‚Äì4196. [CrossRef]
30. Wang, D.C.; Ding, Y.F.; Zhu, C.X. A fault diagnosis method for gearbox based on neutrosophic K-Nearest
Neighbor. Shock Vib. 2019 ,38, 148‚Äì153. [CrossRef]
31. Wang, W.Q.; Yang, S. A method for choosing the wavelet decomposition level in structural fault analysis.
Struct. Environ. Eng. 2009 . [CrossRef]
32. Wu, C.Z.; Jiang, P .C.; Feng, F.Z.; Chen, T.; Chen, X.L. Gearbox Faults diagnosis method for gearboxes based
on 1-D convolutional neural network. Shock Vib. 2018 ,37, 51‚Äì56. [CrossRef]
¬©2020 by the authors. Licensee MDPI, Basel, Switzerland. This article is an open access
article distributed under the terms and conditions of the Creative Commons Attribution
(CC BY) license (http: //creativecommons.org /licenses /by/4.0/).
------------------------------End of the page -----------------------------------
