Acta Polytechnica Hungarica  Vol. 18, No. 6, 2021 
 – 175 – Fault Detection of a Wind Turbine's Gearbox , 
based on Power Curve Modeling and an on -line 
Statistical Change Detection Algorithm  
Basheer W. Shaheen1, Ahmed Abu Hanieh2, István Németh1 
1Department of Manufacturing  Science and Engineering, Budapest University of 
Technology and Economics, Műegyetem rkp. 3, 1111 Budapest, Hungary, 
shaheen.basheer@gpk.bme.hu , nemeth.istvan@gpk.bme.hu  
2Department of Mechanical and Mechatronics Engineering, Birzeit University,  
97200, Palestine, ahanieh@birzeit.edu  
Abstract:  An early model-based fault detection was developed , based on  the wind turbine 's 
power curve to detect the degradation (faults) in gearbox efficiency, resulted from the 
existing mechanical losses (torque losses) through the low -speed shaft and the high -speed 
shaft, t hen to assist in implementing predictive maintenance strategy. The detection was 
performed on two levels; the first level represents a slight and progressive degradation in 
the gearbox efficiency . The other one represents a radical (abrupt) degradation in the 
efficiency. Artificial SCADA data for different measurements (wind speed and active 
power) in both fault -free and faulty operating modes were generated using a FAST -NREL 
simulator. The wind turbine  power curves ' parameters were estimated, then power 
residuals were generated from each power point. Finally,  an on-line CUSUM statistical 
change detection algorithm was used to evaluate and detect small changes in power 
residuals generated from the model. The presented fault detection system successfully 
detected faults in both detection levels under realistic wind turbulence and with a fault 
magnitude of 2% efficiency degradation for the progressive degradation level.  
Keyw ords:  fault detection; SCADA ; wind turbine; condition monitoring ; change -point 
detection ; simulation ; optimization  
1 Introduction  
Currently, wind energy is one of the primary  renewable energy sources used to 
generate electrical power . Experts expect that more than 355 Gigawatt s of new 
capacity will be added between 2020 and 2024 [1]. This ene rgy source plays a 
key role in reducing the harmful effects of other,  traditional electrical power 
generation methods , such as , fossil fuels, coal and natural gas , which contribute 
to global warming and have  increase d the levels atmospheric carbon dioxide 
(CO2) [2].  
------------------------------End of the page -----------------------------------
B. Shaheen et al.  Fault Detection of Wind Turbine’s Gearbox based on Power  CURVE modeling and  
 an on -line Statistical Change Detection Algorithm  
 – 176 – Electricity generation using  wind and wind turbines , is considered to be one of 
the cleanest, environmentally friendly , electricity generation methods, accepted 
by society and has numerous competitive economic  advantages [3]  [2].                  
The efficiency of the power generation from a Wind Turbine (WT) could be 
increased by better controlling the wind turbine 's operations , according to the 
information related to wind state changes and the turbine location [4].  
The wind energy conversion system is known as a Wind Turbine. A wind turbine 
can be defined as "a rotating mechanical device that converts wind kinetic energy 
to practical mechanical energy, resulting in electricity production " [5]. Wind 
turbine s have two common types; horizontal axis wind turbines (HAWT) and 
vertical axis wind turbines (VAWT) [6]  [7]. According to [6], the most used  
design is HAWT , for which the axis of rotation is parallel to the ground s surface , 
as shown in Figure 1.  
 
Figure 1  
HAWT main  components  
The main goal of this research is to develop an early , model -based , fault 
detection  method  and to monitor the performance degradation of WT s (faults 
through the gearbox ) based on  the WT 's power curve, using artificial (simulated) 
supervisory co ntrol and data acquisition (SCADA ) data (typically sampled at low 
frequency). This performance degradation (power loss) is typically due to the 
degradation in the Gear Box Efficiency (GBoxEff ) resulted from the existing 
mechanical losses (torque losses) through the low -speed shaft (LSS) and the 
high-speed shaft (HSS). This model can be enhanced  by a successful 
implementation of a predictive maintenance strategy , to reduce the associated 
mainte nance costs and produce better maintenance plann ing and scheduling 
activities.  

------------------------------End of the page -----------------------------------
Acta Polytechnica Hungarica  Vol. 18, No. 6, 2021 
 – 177 – A polynomial model and the least-squares algorithm for polynomial parameters 
estimation were used  as a model structure.  Model -based fault detection was 
performed for the power r esidual generated from the model and using residuals ' 
evaluation modules , based on CUSUM statistical change detection algorithm and 
for two different levels of gearbox efficiency degradation . The first degradation 
level was for a progressive (slight) degra dation in GBoxEff , and the other level 
represented a radical or abrupt degradation in the efficiency.  
2 Literature Review  
According to Tchakoua et al. [8] , the operations and maintenance (O&M) costs 
of wind turbines farm are supposed to be higher than the traditional power 
generation methods due to the remote locations of such farms,  the bad weather 
conditions , and other variables. Thus, the development of fault diagnosis systems 
to provide an early warning of faults and predict ion, with health condition 
monitoring system s, are need ed to reduce the O&M costs [9].  
Most of the research papers focused on condition monitoring systems (CMS) 
tools to diagnose faults and monitor the health of wind turbines, which include 
"sensors, signal acquisition , and processing software, cabling and installations 
that gives continuous information about the monitored component condition " [5]. 
CMS is used in offshore wind turbines , especially , to monitor the most critical 
components in the WT system, such as gearbox , generator, rotor blades,  and yaw 
actuator [5]  [8]. To determine the portion of each the WT components , out of the 
total number of failures that occurred , Hahn et al. [10]  reported a survey of 1500 
WTs over a period of 15 years that indicated five compone nt groups, "electrical 
system, control system, hydraulic system, sensors, and rotor blades " are 
responsible for 67% of the failures that occur red. 
Different data analysis and data mining algorithms such as Fuzzy logic, artificial 
neural network (ANN), support vector machine (SVM), neural network , and deep 
belief networks were used in many research  works  to detect/predict the faults and 
to monitor the health conditions of the WTs [11 -15]. 
In order to develop a WT 's CMS , we need data to validate the model; in  modern 
WTs, SCADA data systems are commonly used  [16]. SCADA systems for data 
analysis of WTs condition monitoring (CM) are cost -effective, reliable , and 
practical [1 7]. The principle of a SCADA system is based on collecting extensive 
information from key WT subassemblies using sensors installed on the WT [8]. 
The operational data of a WT usually indicate either the WT status or 
measure ment  signals, such as wind speed, temperature, power , and current , 
which reflect the real-time condition of the WT components. By analyzing the 
SCADA data , these signals and the different relationships between them can be 
observed , and the condition (health) of the WT can be concluded [1 8]. Tao et al. 
------------------------------End of the page -----------------------------------
B. Shaheen et al.  Fault Detection of Wind Turbine’s Gearbox based on Power  CURVE modeling and  
 an on -line Statistical Change Detection Algorithm  
 – 178 – [19] used  an efficient SCADA data mining method to detect anomalies of the 
wind turbines using combinations of data pre -processing algorithms such as grey 
correlation algorithm to extract the eigenvectors of the monitored data. Support 
vector regression (SVR) param eters were optimized through the genetic 
algorithm and cross -validation method, result ing in a high pr ecision fault 
prediction model.  
Similarly, Corley et al. [20] predicted the anomalies from measured SCADA data 
in wind turbine gearbox es using combined thermal modeling and machine 
learning method . 
In Schlechtingen et al . [21] [22], a wind turbine condition monitoring (WTCM ) 
system based on SCADA data, using normal behavior models and adaptive 
neuro -fuzzy inference systems (ANFIS) was presented. It is worth  mentioning 
that it is difficult to detect a fault from raw SCADA data without using an 
appropriate data analysis tool [2 2]. Another research work by Yang et al. [2 3] 
focused on developing a cost -effective and reliable CM (technique) for WT 
blades and driv ers through the interpretation of SCADA data collect ed from a 
farm of WTs. In Zaher et al. [2 4] and Zhang and Wang [2 5], different techniques 
for anomaly detection in WTs based on SCADA data using an ANN were used. 
The results indicated that the proposed t echniques for SCADA data interpretation 
could identify the early faults and give a WT performance assessment to give the 
system's operator sufficient time to make the needed decisions concerning the 
machine maintenance process.  
Similarly, Godwin and Matth ews [2 6] proposed a data -driven system to classify 
the faults associated with WT pitch through SCADA data. Data were collected 
from 8 WTs every 10 minutes over a period of 28 months. Another research work 
of Kusiak and Li [2 7] used many data mining algorit hms to develop  a fault 
detection and identification  (FDI) system including many WT 's components; 
fault data were obtained by SCADA data system , and fault prediction was 
applied through 3 levels, which include fault -no fault prediction, fault 
classification  into categories and prediction of specific types of faults ; fault 
prediction model in this study was developed using different types of data mining 
algorithms including, the Neural Network (NN), the Standard Classification and 
Regression Tree (CART), the Boosting Tree Algorithm (BTA), and the Support 
Vector Machine (SVM). Likewise, Yuan et al. [9] presented a wind turbine 
gearbox fault prediction approach based on SCADA data. The normal conditions 
of the WT were modeled using a stacking model consisted of  Random Forest 
(RF), Gradient Boosting Decision Tree (GBDT), and Extreme Gradient Boosting 
(XGBOOST). The Mahalanobis distance (MD) method instead of the residual 
generation was used to measure the deviation of the current conditions from the 
normal condit ions of the turbines. Lastly, a change -point detection algorithm 
based on  cumulative summation (CUSUM ) was used to predict the resulted 
faults.  
------------------------------End of the page -----------------------------------
Acta Polytechnica Hungarica  Vol. 18, No. 6, 2021 
 – 179 – Likewise , Borchersen and Kinnaert [2 8] proposed and tested an early  model -
based fault detection for the cooling system of WT 's generator. In this study, the 
model parameters were estimated on -line using an extended Kalman filter, and 
then residuals were evaluated by CUSUM statistical change detection algorithm 
in order to  detect the small faults. Another related research by Pujol -Vazquez et 
al. [2 9] developed an innovative approach to detect faults in the WT 's pitch 
actuator system based on the interval observer framework theory , which has been 
proved to be an efficient me thod to measure the uncertainties in dynamic 
systems.  
In general , fault detection based on SCADA data can be conducted using 
different modeling and analysis techniques as presented in the previous works.  
3 Proposed Fault Detection Framework  
Figure 2 below  presents  the overall framework  used to detect /predict the gearbox 
faults in different efficiency degradation levels . It is composed of  three  main 
phases. The first phase is the Artificial SCADA data simulation /generation, in 
which SCADA data for different meteorological and mechanical conditions are 
simulated, then raw SCADA points are generated. The second phase is the 
modeling phase . It contains (i) the data pre -process ing where  outlying and 
unnecessary data are filtered from the raw SCADA  data; (ii) the  power curve 
construction that is based on the generated power and wind  speed ; and (iii) the 
parameters estimation that uses  an appropriate regression method. Through the 
application phase, power residuals are generated based on the healthy and faulty 
processed SCADA data and for different levels of gearbox efficiency 
degradation. Then, the estimated model is partially validate d based on the least 
mean squared error . Finally , the change -point detection based on CUSUM 
algorithm (recursive form) is applied to implement the fault detection /prediction 
model.  
------------------------------End of the page -----------------------------------
B. Shaheen et al.  Fault Detection of Wind Turbine’s Gearbox based on Power  CURVE modeling and  
 an on -line Statistical Change Detection Algorithm  
 – 180 –  
Figure 2  
Fault detection framework  
3.1 Artificial SCADA Data Simulation  
3.1.1 The Wind Turbine Simulator  
The wind turbine simulator used in this research consisted of a set of codes that 
were developed by NREL (USA Government based, National Renewable Energy 
Laboratory) . For example, the AeroDyn  code conducts aerodynamic calculations 
while  the FAST code conducting the aeroelastic simulation. Both together 
simulate the wind turbine 's mechanical behavior. The control scheme of all 
operations of the wind turbine has been added to the aforementioned two codes 
through SIMULINK in MATLAB. The needed wind input files to AeroDyn and 
FAST codes were modeled and generated through TurbSim software depending 
on the required input parameters such as mean wind speed ad turbulence intensity 
(TI) [30-32]. 
3.1.2 Simulation Basic Characteristics  
For the simulation process, meteorological conditions were set as illustrated in 
Table 1 . Table 2 shows the main control parameters  used during the simulation s. 
Table 1  
Meteorological conditions  for the simulation s 
Turbulence Model  IECVKM=Kaimal  
IEC standard  1-ED2 
Turbulence intensity percent  10-20% 
Wind profile type  Normal  

------------------------------End of the page -----------------------------------
Acta Polytechnica Hungarica  Vol. 18, No. 6, 2021 
 – 181 – Height of reference wind speed  84.672 m  
Mean of the wind speed at the reference height  2-18 m/s  
Power law exponent  0.3 
Table 2  
Main simulation control parameters  
Total Run time per point  12 minutes  
Module step time  0.005 seconds  
Sampling Frequency  200 Hz  
3.1.3  Artificial SCADA Data Generation  
Two training data sets consisting of simulated (artificial) SCADA are required. 
Fault -free and faulty operating modes are the labels of each training set for 
different gearbox efficiencies. WT 's fault -free (healthy) operating mode means 
that the WT is assumed to be operated with no mechanical losses (torque losses) , 
being transmitted throug h the gearbox ; thus, the GBoxEff (gearbox efficiency) is 
set to 100% . While to simulate losses (the faulty operating mode) , the WT is 
assumed to be operated with mechanical losses (torque losses) being transmitted 
through the gearbox if the GBoxEff is less  than 100% . Thus, the GBoxEff is set 
to 99,  98, 97, and 90% to detect slight and progressive degradation in the 
efficiency (100 -99-98-97% respectively) and radical degradation in the efficiency 
(100-90% at once). When generating power, the FAST method determine s the 
HSS torque according to equation 1  [30]. 
𝐻𝑆𝑆  𝑡𝑜𝑟𝑞𝑢𝑒 =𝐿𝑆𝑆 𝑡𝑜𝑟𝑞𝑢𝑒  ∙ 𝑒𝑓𝑓𝑖𝑐𝑖𝑒𝑛𝑐𝑦
𝑔𝑒𝑎𝑟  𝑏𝑜𝑥 𝑟𝑎𝑡𝑖𝑜 (1)  
When motoring, the FAST method  compute s the torque on the LSS according to 
equation 2 . 
 𝐿𝑆𝑆 𝑡𝑜𝑟𝑞𝑢𝑒 =𝐻𝑆𝑆  𝑡𝑜𝑟𝑞𝑢𝑒  ∙ 𝑔𝑒𝑎𝑟  𝑏𝑜𝑥  𝑟𝑎𝑡𝑖𝑜
𝑒𝑓𝑓𝑖𝑐𝑖𝑒𝑛𝑐𝑦         (2) 
It is worth mentioning that t he simulated wind turbine in this research is from the 
type of "DeWindD6 " with 1250 kW rated electrical power.  
3.1.4 DeWindD6 Power Curve Characteristics  
The power curve of DeWindD6 WT is illustrated in Figure 3 , which depicts the 
power curve of DeWindD6 WT and features three key wind speeds . 
Where the cut -in wind speed is the wind speed , at which the WT starts generating 
power, nominal wind speed is the wind speed at which the WT reaches the 
nominal power output,  knowing that it is possible to generate higher power 
output above the nominal wind speed, but the control system maintain s a constant 
power to limit loads and stresses on WT 's blades.  
------------------------------End of the page -----------------------------------
B. Shaheen et al.  Fault Detection of Wind Turbine’s Gearbox based on Power  CURVE modeling and  
 an on -line Statistical Change Detection Algorithm  
 – 182 –  
Figure 3  
Nominal power curve of DeWindD6 WT  
Lastly , the cut-out wind speed  is the highest wind speed at which the WT can 
operate [3 3]. 
3.2 Data Pre-Processing  
The resulted mean wind speed (𝑤𝑗) is a 10 minute average wind speed out of 12 
minutes of total run time, where the first two minutes were assumed to be the 
transient time of the simulated  measurement  data (i.e., power and wind speed) ; 
thus, corresponding data were removed . 
3.3 Power Curve  Construction  
For each simulated measurement  (j), the scalar average wind speed ( wj) was 
calculated according to equation 3.  
𝑤𝑗=1
𝑛∑𝑤𝑖𝑛
𝑖=1 (3) 
Where (𝑤𝑖) is the wind speed generated by the simulator with time step 0.005 
seconds. The s ame procedures were used to calculate the corresponding output 
power ( p). The power curve consists of primarily two input variables: wind speed 
and power output. Using FAST -AeroDyn simulator from NREL, and following 
the simulation characteristics of DeWindD6 WT, raw artificial SCADA data 
(active power), typically sampled at low frequency: from 30 s to 10 minutes , 
were generated along with wind speed required to construct the power curve.  
According to IEC 61400 -1 standard, the wind s peed of the power curve is "the 
undisturbed free -stream wind speed at hub height, normalized for a certain air 
density " [34]. Once the simulation process was complete, 10 minutes ' averages of 
wind speed and active power were generated for  1000 points for e very single 
GBoxEff percentage.  

------------------------------End of the page -----------------------------------
Acta Polytechnica Hungarica  Vol. 18, No. 6, 2021 
 – 183 – Figure 4 depicts a sample scatter plot of wind speed characterized by mean wind 
speed against active power output (i.e., the power curve) for both fault -free 
(GBoxEff=100%) and faulty operating modes (i.e., GBoxEff=90%).  
 
Figure 4  
Sample of power curve's scatter plot from raw SCADA data for both fault -free and faulty operating 
modes  
3.4 Mathematical Modeling and Parameters Estimation  
To study the system 's behavior, we need to generate the system 's residuals.       
The l east-squares (LS) algorithm is used to estimate the model that describes the 
system (wind turbine power curve) and to generate the system 's residual in 
addition to study the behavior of the system according to the obtained artificial 
SCADA data from FAST -AeroD yn Simulator (experimental data).  Likewise, 
according to the experimental data, a model that describes the system behavior 
was formulated to explain the experimental data and allowed to make predictions 
of the future responses of the system (WT power curve ). Consequently, 
systematic procedures were applied to generate the system 's residuals preparing 
for the fault detection test.  
WT's Power Curve Model Formulation  
A parametric model of WT 's power curve is chosen to describe the system. 
Parametric models assume some finite set of parameters ( 𝜃), given the 
parameters, future predictions ( 𝑝̂) which are independent of the experimental data 

------------------------------End of the page -----------------------------------
B. Shaheen et al.  Fault Detection of Wind Turbine’s Gearbox based on Power  CURVE modeling and  
 an on -line Statistical Change Detection Algorithm  
 – 184 – (𝑝). These parameters are usually collected  from a single parameter vector 
𝜃=[𝜃1 𝜃2 ...𝜃𝑛] [35]. 
WT Power Curve  Model Structure  
Polynomial expressions of different orders (degrees) are widely used in many 
works found in the  literature  [36] to model  the WT's power curve . In this 
research , a polynomial model was used to describe the WT 's power curve as a 
simple empirical model . 
Given the power curve of m data pairs of power ( p1, p2, … .., pm) versus wind 
speed ( w1, w2,…..,w m), an nth order polynomial was defined as follows : 
 𝑝̂(𝑤)=𝑎1𝑤𝑛+𝑎2𝑤𝑛−1+⋯+𝑎𝑛𝑤+𝑎𝑛+1 (4) 
It is worth mentioning that the fitted model is linear in its parameters.  
The main objective is to minimize the least square error between the fitted value 
and the actual value as:  
 {𝑎𝑙}=argmin ∑{(𝑝𝑗−𝑝̂(𝑤𝑗))2
}𝑚
𝑗=1 (5) 
where {𝑎𝑙} is the set of polynomial coefficients, l  [1; n+1 ]. 
Modeling assumptions and parameter estimation  
To fulfill the abovementioned objective, the LS algorithm was used to fit the 
power curve data and generate residual from the fitted polynomial model 
(residual generator).  The LS  algorithm estimates the coefficients of the model 
(parameters) by minimizing the summation of squares of the residuals.  
3.5 Power Residuals Generation  
Residuals can be calculated as the following:  
Where  𝑟𝑖 is the power residual,  𝑝𝑖 is the actual power , and 𝑝̂𝑖 is the estimated 
power based on the power curve model.  
Figure 5 depicts a sample of power residuals generated from the estimated 6th-
degree polyn omial model for fault -free operating mode ( 𝑘≤1000 ) and faulty 
operating mode (𝑘>1000 ). In faulty mode , the wind speed is increasing from 2  
m/s to 18 m/s , and then it is reversed from 18  m/s to 2 m/s (to avoid the abrupt 
degradation in wind speed) . The right side of the figure (i.e., 𝑘>1000 ) shows  
faulty mode with GBoxEff=90% where wind speed is changing from 18  m/s to 2 
m/s.  𝑟𝑖=𝑝𝑖−𝑝̂𝑖 (6) 
------------------------------End of the page -----------------------------------
Acta Polytechnica Hungarica  Vol. 18, No. 6, 2021 
 – 185 – Note that in the case of the fault-free operating mode ( 𝑘≤1000  in Figure 5), the 
variance of the first 400 points is smaller tha n the rest . This set of points  are 
located within a low wind speed area in which the residuals ha ve a small 
magnitude (superimposed). In the case of the faulty operating mode  (𝑘>
1000  in Figure 5), it is the opposite: the variance of the last 400 points is smaller . 
 
Figure 5  
Sample from the generated residuals - fault-free and 90% GBoxEff faulty mode- time on the x -axis is 
expressed as the number of samples  
3.6 Model Validation  
The regression model was validated (limited validation within the same data set ) 
by analyzing the  goodness of fit  of the regression by calculating the mean 
squared error (MSE) between the actual (experimental) data and the fitted model 
(measured).  
The MSE is a measure of the quality of an estimator, it is always positive, and the 
smaller  value is , the better.  
 𝑀𝑆𝐸 =1
𝑛∑(𝑝𝑖−𝑝̂𝑖)2𝑛
𝑖=1 (7) 
Where n is the number of data points of the power,  𝑝𝑖 is the actual power 
(experimental) and 𝑝̂𝑖 is the estimated (measured) power.  
The MSE of the fitted polynomial models with order (degree) 3 up to order 6 are 
illustrated in Table 3, the smaller  MSE between the experimental data and the 
fitting is selected.  
Thus, a 6th-degree polynomial model is the best fit for the experimental data and 
could be considered an accepted model.  

------------------------------End of the page -----------------------------------
B. Shaheen et al.  Fault Detection of Wind Turbine’s Gearbox based on Power  CURVE modeling and  
 an on -line Statistical Change Detection Algorithm  
 – 186 – Table 3 
Best fit -polynomial degree  
 Polynomial degree  
Fault -free operating mode  
GBoxEff 100%  3rd 4th 5th 6th 
MSE  1657.3  1339.5  765.1  651.7  
 
Figure 6  
Superposition of the fault -free residuals in blue and the faulty residuals in red  
Power residuals are assumed "approximately " to be nor mally distributed.          
The histogram in Figure 6 shows the superposition of the fault -free residuals in 
blue and the faulty residuals in red.  
3.7 Mathematical Model of the Identified System  
Referring to equation 4, the 6th-degree  polynomial model that fit the experimental 
data of the fault -free operational mode of the WT is considered as the first 
developed model in this research and described below as a function of wind 
speed:  
𝑝̂(𝑤𝑖)= 0.0012 𝑤𝑖6 − 0.0523 𝑤𝑖5 + 0.7154 𝑤𝑖4 − 3.0313 𝑤𝑖3 +
 5.3390 𝑤𝑖2 + 3.2694 𝑤𝑖 + 1.2002  (8) 
Where:   𝑝̂(𝑤𝑖) is the measured power, and 𝑤𝑖 is the wind speed.  
Figure 7 shows the estimated 6th degree polynomial model.  

------------------------------End of the page -----------------------------------
Acta Polytechnica Hungarica  Vol. 18, No. 6, 2021 
 – 187 –  
Figure 7  
Power curve estimated model: fault-free mode  (GBoxEff=100% ) 
3.8 Tuned Model toward the Nominal Power Curve  
Referring to the manufacturer 's nominal power curve (Figure 3), the rated power 
at the nominal wind speed (12.5 m/s) should be a constant.  
Thus, a new (tuned) power curve model depicted in Figure 8 is formulated  to be 
more consistent with the manufacturer 's nominal power curve at power limitation 
or constant power region ( see region C in Figure 3 ). 
To achieve this, a non -linear optimization fit was performed through constrained 
function minimization , as depicted in Figure 8 . The polynomial coefficients  can 
be determined as follows:  
 {𝑎𝑙}=min ∑(𝑝𝑖−𝑝̂(𝑤𝑖))2608
𝑖=1 (8) 
Subject to : 
𝑝̂(12.5)=𝑃𝑟 
where {𝑎𝑙} is the set of polynomial coefficients , l  [1; 7], and 𝑃𝑟 is the rated 
power . 
The optimization problem in (9) was simplified using a penalty function to 
convert the constrained problem into an unconstrained problem. The general 
technique is to add a component  to the objective function that produces a high 
cost if the  constraint  is violat ed, as is indicated in equation  (10). 

------------------------------End of the page -----------------------------------
B. Shaheen et al.  Fault Detection of Wind Turbine’s Gearbox based on Power  CURVE modeling and  
 an on -line Statistical Change Detection Algorithm  
 – 188 – {𝑎𝑖}=min ∑(𝑝𝑖−𝑝̂(𝑤𝑖))2608
𝑖=1+𝜆|𝑃𝑟−𝑝̂(12.5)| (9) 
Where 𝜆 is the penalty coefficient , and point ( i=608) is the corresponding point 
of the fault -free mode in which the wind speed  (𝑤𝑖) is equal to  12.5 m/s where  
the constant power generation (region C)  starts.  
  
Figure 8  
Tuned power curve estimated model based on the nominal power curve  
4 Fault Detection: CUSUM Statistical Change 
Detection Algorithm  
The generated residuals are evaluated using an on -line CUSUM statistical change 
detection algorithm to perform the fault detection (performance degradation).  
4.1 Residual Evaluation  
The general purpose of a cumulative summation (CUSUM ) test is to test two 
hypotheses , ℋ0 and ℋ1, against each other to determine which of them describes 
the data . In our study , ℋ0 and ℋ1 represent the fault -free and faulty operating 
modes, respectively.  
In order to detect small changes in the power residuals, the CUSUM statistical 
change detection algorithm was used for e very single power residual point.  

------------------------------End of the page -----------------------------------
Acta Polytechnica Hungarica  Vol. 18, No. 6, 2021 
 – 189 – The power residuals vector was not evaluated at once due to the changes in the 
off-diagonal values of the residual covariance matrix , which are changing 
significantly over time ; thus, the matrix should be updated continuously.             
To avoid this , positive change detection in the residuals ' mean was applied using 
the CUSUM algorithm for each power residual component  [28]. 
We have a scalar set of power residuals {r (1),...., r(k)} : 
Assuming that the power residuals approximately follo w a Gaussian (normal) 
distribution,  and the probability distribution function is: 
 𝑝𝜇(𝑧)=1
𝜎√2𝜋 𝑒𝑥𝑝−(𝑟−𝜇)2
2𝜎2 (10) 
The hypotheses are as the following:  
ℋ0: 𝑟(𝑖)~ 𝒩(𝜇0,𝜎2) 𝑓𝑜𝑟 𝑖=(1,…,𝑘) 
ℋ1: 𝑟(𝑖)~ 𝒩(𝜇0,𝜎2) 𝑓𝑜𝑟 𝑖=(1,…,𝑘0) ,𝑟(𝑖)~ 𝒩(𝜇1,𝜎2) 𝑓𝑜𝑟 𝑖=(𝑘0,…,𝑘) 
Where:  
 𝑘0 is the unknown change time  
 𝜇0 and 𝜇1 are the residual means before and after the possible change  
The corresponding log -likelihood ratio 𝑠(𝑖)  for detecting a change in the residual 
mean from 𝜇0 and 𝜇1 can be calculated as the following : 
 𝑠(𝑖)=  𝜇1−𝜇0
𝜎2(𝑟(𝑖)−  𝜇1+𝜇0
2) (11) 
Where  𝛽= 𝜇1−𝜇0 is the change in the mean and 𝑏=  𝜇1−𝜇0
𝜎 is the signal -to-
noise ratio.  
Figure 9 depicts (radical degradation at gearbox efficiency) the corresponding 
log-likelihood ratio 𝑠(𝑖)  for the residuals with 𝜇0=0.0043  before k=1000,   
𝜇1=-34.146 after k=1000,  𝜎=25.5353  calculated from equation (12).  
Note that the typical behavior of the log -likelihood ratio 𝑠(𝑖)   shows a negative 
drift before the change (before k=1000), and a positive drift after the change 
(after k=1000) as depicted in Figure 9.  
------------------------------End of the page -----------------------------------
B. Shaheen et al.  Fault Detection of Wind Turbine’s Gearbox based on Power  CURVE modeling and  
 an on -line Statistical Change Detection Algorithm  
 – 190 –  
Figure 9  
Log-Likelihood ratio of the residuals ( residuals realization), radical GBoxEff degradation, time on the 
x-axis is expressed as the number of samples  
The recursive form of the CUSUM algorithm is an efficient and practical way to 
implement the CUSUM algorithm. Depending on the fact that the threshold 'h' is 
always positive , only the contributions to the cumulative sum that add up to a 
positive number must be considered to determi ne the decision function  [37]. 
The recursive calculation of the decision function is as the following:  
 𝑔(𝑘) = 𝑚𝑎𝑥  (0; 𝑔(𝑘− 1) + 𝑠(𝑘)) (12) 
And the alarm function is:  
 𝑑(𝑘)={1, 𝑖𝑓 𝑔(𝑘)>ℎ
0,           𝑜𝑡ℎ𝑒𝑟𝑤𝑖𝑠𝑒 (13) 
The recursive CUSUM test was implemented on the residuals ' sets and on two 
levels; level one represents the progressive (slight) degradation in gearbox 
efficiency (GBoxEff: 100 -99-98-97% respectiv ely), and the other level represents 
the radical degradation in gearbox efficiency (GBoxEff: 100 -90% at once).  
A user-defined threshold  was defined  to avoid or reduce the false alarm and 
missed detection due to the variations of the parameter s. The user-defined 
threshold needs to consider the maximum magnitudes of residuals under the 
fault-free test . It is defined as follows:  
 ℎ=1.5 ∗(𝑚𝑎𝑥  𝑔(𝑘) 𝑏𝑒𝑓𝑜𝑟𝑒  𝑘=1000 ) (14) 
Where μ1 is the average of the means for faulty modes (99 .98 and 97%).  
The stopping time (also called alarm time) 𝑘𝑎, is the time instant at which g(k) 
crosses the user -defined positive threshold h: 
 𝑘𝑎=𝑚𝑖𝑛 {𝑘:𝑔(𝑘)≥ℎ} (15) 

------------------------------End of the page -----------------------------------
Acta Polytechnica Hungarica  Vol. 18, No. 6, 2021 
 – 191 – The fault occurrence time 𝑘0, can be estimated as the time instant 𝑘̂0 at which 
S(k) has changed from a negative to a positive slope. It is formally expressed as: 
 𝑘̂0=𝑘𝑎−𝑁(𝑘𝑎) (16) 
Where N(k) is the number of successive observations for which the decision 
function remains strictly positive.  
 𝑁(𝑘)=𝑁(𝑘−1)1{g(k−1)>0}+ 1 (17) 
where 1{ x} is the indicator of event  x, namely, 1{ x} = 1 when  x is true, and 1{ x} 
= 0 otherwise.  
In equation  (14), if 𝑔(𝑘)>ℎ, an alarm is issued, and an estimate of the change 
occurrence time 𝑘̂0 is provided by  equation  (17), and the decision function is re-
initialized to 0.  
The re -initialization after an alarm allowed us to check whether the change in the 
mean persists as time elapses or not. The result is a sequence of alarm time 
instants 𝑘𝑎 and estimated change occurrence times 𝑘̂0 for increasing time horizon 
k. 
Figures 10 and 11 below depict the evolution of the recursive CUSUM decision 
function with re -initialization when an alarm has been issued for the radical and 
progressive degradation with 𝜇0 before k=1000, and with 𝜇1 after k=1000.  
 
Figure 10  
Evolution of the recursive CUSUM decision functions with re -initialization ( radical degradation, 
GBoxEff=100 -90%) , time on the x -axis is expressed as the number of samples  

------------------------------End of the page -----------------------------------
B. Shaheen et al.  Fault Detection of Wind Turbine’s Gearbox based on Power  CURVE modeling and  
 an on -line Statistical Change Detection Algorithm  
 – 192 – For the case of radical gearbox efficiency degradation; from eq uation (16), the 
stop alarm  is 𝑘𝑎=1009 , while from equations (17) and (18), the fault 
occurrence time estimate  is 𝑘̂0= 986. 
In Figure 10, it  can be seen  that there is a regular cross of the threshold started 
from k=1235 , due to the relatively large signal -to-noise ratio; this indicates that a 
permanent failure has occurred.  
 
Figure 11  
Evolution of the recursive CUSUM decision functions with re -initialization ( progressive degradation, 
GBoxEff=100 -99-98-97%) , time on the x-axis is expressed as the number of samples  
The threshold value h is calculated for each case according to equation (15). 
Similarly, for the level of progressive gearbox efficiency degradation , the stop 
alarm  is 𝑘𝑎=2397 , while the fault occurrence time  estimate  is 𝑘̂0= 1524 . 
There is no regular cross of the threshold because the signal -to-noise ratio is 
small ; accordingly , the algorithm need s more time for the detection.  
As shown in  Figures 10 and 11, the CUSUM of the log-likelihood ratio is 
increasing during the fault occurrence. A more increment (higher slope) indicates 
a larger fault magnitude presence (larger percent of degradation in GBoxEff).    
At the time when  the GBoxEff changed from fault-free mode to faulty mode, i.e. , 
k=1000 , there is a detection time delay ; this delay may occur due to the  value of 
threshold h. 
Detection time delay is expressed as the number of samples ; for the radical 
GBoxEff degradation , it is 9, while for progressive GBoxEff degradation , it is 
1397.  This could be inter preted by a high value of threshold h. At the same time , 
if we set the threshold to a lower value , there may be issues of false alarms.         
It indicates  that there is a trade -off between false alarms and detection time.  

------------------------------End of the page -----------------------------------
Acta Polytechnica Hungarica  Vol. 18, No. 6, 2021 
 – 193 – From Figure s 10 and 11 it can be conclud ed that the larger the fault (larger 
percent of degradation in GBoxEff), the shorter the detection time.  
Conclusions and Future Work 
In this research, an early fault detection model for the Wind Turbine  gearbox , 
was presented. The power residuals of the model were assumed to be normally 
distributed; the small deviations residuals should not affect the detection .          
As found in the literature, the CUSUM algorithm has high robustness to non -
normality , and it  is effective in detect ing the  changes in all siz es, even in highly 
skewed and heavy -tailed process distributions.  The results of power residuals ' 
evaluation using the CUSUM algorithm have been observed for the estimated 
model and all degradation levels . For progressive GBoxEff degradation level, the 
developed fault detection system was able to detect a fault magnitude of 2% 
under realistic wind turbulence. For the radical degradation level, the fault 
detection time was shorter than the progressive degradation , the larger the fault, 
the shorte r the detection time.  
Thus, it can be concluded that the artificial SCADA data simulated by 
FAST_NREL , could be used as an efficient source of measurements with the 
absence of well -documented real SCADA data to study the behavior of a specific 
component of WT a nd to perform model -based fault detection , then to help to 
understand  the fault effects. This allows better planning for maintenance 
activities  and gives a better opportunity to implement a predictive maintenance 
strategy , that can result in the reduc tion of maintenance costs and increas e the 
reliability of the WT.  
This work was validated for one fault type, and one fault indicator was analyzed 
in the gearbox based on the power curve . This can be used as a framework in the  
future , to develop a model -based f ault detection in WT 's gearbox and to include 
other fault indicators , which could affect the WT 's performance and predict , for 
instance,  the remaining useful  life ( RUL ) of the gearbox component , as a fault 
indicator. Further work can be done by considering  a full fault diagnosis study , 
that includes , fault detection, isolation and estimation . In addition,  the proposed 
model can be  validate d and the efficiency  can be  tested on real SCADA data. 
Moreover, as future work, power curve parameters and fault detection could be 
predicted using machine learning algorithms , such as ANN , for more prediction 
accur acy when  dealing with  a large  amount of data or more complex systems .   
As a result , full implementation of a predictive maintenance strategy , could be 
carried out , based on this research , aimed at the development of  even better 
mainten ance planning and any associated scheduling activities . 
Acknowledgment  
The authors would like to thank the Department of Control Engineering and 
System Analysis at the Free University of Brussels (ULB) and the head of 
department Prof. Michel Kinnaert for funding and supervising this research.  
------------------------------End of the page -----------------------------------
B. Shaheen et al.  Fault Detection of Wind Turbine’s Gearbox based on Power  CURVE modeling and  
 an on -line Statistical Change Detection Algorithm  
 – 194 – References  
[1] Global Wind Energy Council, "Global Wind Report 2019, " 2019  
[2] IEA, "World Energy Outlook 2019 – Analysis, " 2019  
[3] P. Kádár, "Pros and cons of the renewable energy application, " Acta 
Polytechnica Hungarica, Vol. 11, No. 4, pp. 211 -224, 2014, DOI: 
10.12700/aph.25.04.2014.04.14  
[4] M. Monfared, H. Rastegar, and H. M. Kojabadi, "A new strategy for wind 
speed forecasting using artificial intelligent methods, " Renewable Energy, 
Vol. 34, No. 3, pp. 845 -848, Mar. 2009, DOI: 
10.1016/j.renene.2008.04.017  
[5] B. Abichou, D. Flórez, M. Sayed -mouchaweh, H. Toubakh, B. François, 
and N. Girard, "Fault Diagnosis Methods for Wind Turbines Health 
Monitoring : a Review, " European Conference of the Prognostics and 
Health Management Society 2014, no. August, pp. 1 -8, 2013, DOI: 
10.13140/2.1.1150.6563  
[6] J. Feng and W. Z. Shen, "Design optimization of offshore wind farms with 
multiple types of wind turbines, " Applied Energy, Vol. 205, no. August, 
pp. 1283 -1297, 2017, DOI: 10.1016/j.apenergy.2017.08.107  
[7] M. Carlberg, "Quantify Change in Wind Turbine Power Performance 
Using Only SCADA Data, " KTH, 2015  
[8] P. Tchakoua, R. Wamkeue, M. Ouhrouche, F. Slaoui -Hasnaoui, T. 
Tameghe, and G. Ekemb, "Wind Turbine Condition Monitoring: State -of-
the-Art Review, New Trends , and Future Challenges, " Energies, Vol. 7, 
No. 4, pp. 2595 -2630, Apr. 2014, DOI: 10.3390/en7042595  
[9] T. Yuan, Z. Sun, and S. Ma, "Gearbox fault prediction of wind turbines 
based on a stacking model and change -point detection, " Energies, Vol. 12, 
No. 22, 2019, DOI: 10.3390/en12224224  
[10] B. Hahn, M. Durstewitz, and K. Rohrig, "Reliability of Wind Turbines: 
Experiences of 15 years with 1,500 WTs, " Wind Energy: Proceedings of 
the Euromech Colloquium, no. July, pp. 329 -332, 2007, DOI: 
10.1007/978 -3-540-33866 -6 
[11] P. Santos, L. F. Villa, A. Reñones, A. Bustillo, and J. Maudes, "An SVM -
based solution for fault detection in wind turbines, " Sensors (Switzerland), 
Vol. 15, No. 3, pp. 5627 -5648, 2015, DOI: 10.3390/s150305627  
[12] L. Wenyi, W. Zhenfeng, H.  Jiguang, and W. Guangfeng, "Wind turbine 
fault diagnosis method based on diagonal spectrum and clustering binary 
tree SVM, " Renewable Energy, Vol. 50, pp. 1 -6, 2013, DOI: 
10.1016/j.renene.2012.06.013  
------------------------------End of the page -----------------------------------
Acta Polytechnica Hungarica  Vol. 18, No. 6, 2021 
 – 195 – [13] P. Bangalore and L. B. Tjernberg, "An approach for self evolving neural 
network based algorithm for fault prognosis in wind turbine, " 2013, DOI: 
10.1109/PTC.2013.6652218  
[14] H. Wang, H. Wang, G. Jiang, J. Li, and Y. Wang, "Early fault detection of 
wind turbines based on operational condit ion clustering and optimized 
deep belief network modeling, " Energies, Vol. 12, No. 6, 2019, DOI: 
10.3390/en12060984  
[15] P. Bangalore, S. Letzgus, D. Karlsson, and M. Patriksson, "An artificial 
neural network -based condition monitoring method for wind tur bines, with 
application to the monitoring of the gearbox, " Wind Energy, Vol. 20, No. 
8, pp. 1421 -1438, Aug. 2017, DOI: 10.1002/we.2102  
[16] K. T. Abd -Elwahab and A. A. Hassan, "SCADA data as a powerful tool 
for early fault detection in wind turbine gearb oxes, " Wind Engineering, 
Vol. 1, No. 10, Dec. 2020, DOI: 10.1177/0309524X20969418  
[17] S. Butler, F. O 'connor, D. Farren, and J. V Ringwood, "A feasibility study 
into prognostics for the main bearing of a wind turbine, " 2012, DOI: 
10.0/Linux -x86_64  
[18] B. Chen, D. Zappalá, C. J. Crabtree, and P. J. Tavner, "Survey of 
Commercially Available SCADA Data Analysis Tools for Wind Turbine 
Health Monitoring, " 2014  
[19] L. Tao, Q. Siqi, Y. Zhang, and H. Shi, "Abnormal Detection of Wind 
Turbine Based on SCADA Data Mining, " Mathematical Problems in 
Engineering, Vol. 2019, 2019, DOI: 10.1155/2019/5976843  
[20] B. Corley, S. Koukoura, J. Carroll, and A. McDonald, "Combination of 
Thermal Modelling and Machine Learning Approaches for Fault Detection 
in Wind Turbine Gearboxes, " Energies, Vol. 14, No. 5, p. 1375, 2021, 
DOI: 10.3390/en14051375  
[21] M. Schlechtingen, I. F. Santos, and S. Achiche, "Wind turbine condition 
monitoring based on SCADA data using normal behavior models. Part 1: 
System description, " Applied Sof t Computing Journal, Vol. 13, No. 1, pp. 
259-270, Jan. 2013, DOI: 10.1016/j.asoc.2012.08.033  
[22] M. Schlechtingen and I. F. Santos, "Wind turbine condition monitoring 
based on SCADA data using normal behavior models. Part 2: Application 
examples, " Appli ed Soft Computing Journal, Vol. 14, no. PART C, pp. 
447-460, Jan. 2014, DOI: 10.1016/j.asoc.2013.09.016  
[23] W. Yang, R. Court, and J. Jiang, "Wind turbine condition monitoring by 
the approach of SCADA data analysis, " Renewable Energy, Vol. 53, pp. 
365-376, May 2013, DOI: 10.1016/j.renene.2012.11.030  
------------------------------End of the page -----------------------------------
B. Shaheen et al.  Fault Detection of Wind Turbine’s Gearbox based on Power  CURVE modeling and  
 an on -line Statistical Change Detection Algorithm  
 – 196 – [24] A. Zaher, S. D. J. McArthur, D. G. Infield, and Y. Patel, "Online wind 
turbine fault detection through automated SCADA data analysis, " Wind 
Energy, Vol. 12, No. 6, pp. 574 -593, Sep. 2009, DOI: 10.1002/we.319  
[25] Z. Y. Zhang and K. S. Wang, "Wind turbine fault detection based on 
SCADA data analysis using ANN, " Advances in Manufacturing, Vol. 2, 
No. 1, pp. 70 -78, Mar. 2014, DOI: 10.1007/s40436 -014-0061 -6 
[26] J. L. Godwin and P. C. Matthews, "Classification and detection of wind 
turbine pitch faults through SCADA data analysis, " International Journal 
of Prognostics and Health Management; Special Issue Wind Turbine 
PHM, Vol. 4, 2013  
[27] A. Kusiak and W. Li, "The prediction and diagnosis of win d turbine 
faults, " Renewable Energy, Vol. 36, No. 1, pp. 16 -23, Jan. 2011, DOI: 
10.1016/j.renene.2010.05.014  
[28] A. B. Borchersen and M. Kinnaert, "Model -based fault detection for 
generator cooling system in wind turbines using SCADA data, " Wind 
Energy,  Vol. 19, No. 4, pp. 593 -606, Apr. 2016, DOI: 10.1002/we.1852  
[29] G. Pujol -Vazquez, L. Acho, and J. Gibergans -Báguena, "Fault detection 
algorithm for wind turbines ' pitch actuator systems, " Energies, Vol. 13, 
No. 11, 2020, DOI: 10.3390/en13112861  
[30] B. J. Jonkman and M. L. Buhl, "TurbSim User 's Guide, " 2006  
[31] J. M. Jonkman, G. J. Hayman, B. J. Jonkman, and R. R. Damiani, 
"AeroDyn v15 User 's Guide and Theory Manual, " 2006  
[32] J. M. Jonkman and M. L. Buhl, "FAST User 's Guide, " 2005  
[33] U. Emino glu and S. Ayasun, "Modeling and design optimization of 
variable -speed wind turbine systems, " Energies, Vol. 7, No. 1, pp. 402 -
419, 2014, DOI: 10.3390/en7010402  
[34] I. E. commission (IEC), "IEC 61400 -1:2019, international standard – wind 
turbine, " 2019  
[35] O. Uluyol, G. Parthasarathy, W. Foslien, and K. Kim, "Power curve 
analytic for wind turbine performance monitoring and prognostics, " in 
Proceedings of the Annual Conference of the Prognostics and Health 
Management Society 2011, PHM 2011, 2014, pp. 4 35-442 
[36] M. Lydia, S. S. Kumar, A. I. Selvakumar, and G. E. Prem Kumar, "A 
comprehensive review on wind turbine power curve modeling techniques, " 
Renewable and Sustainable Energy Reviews, Vol. 30, pp. 452 -460, Feb. 
2014, DOI: 10.1016/j.rser.2013.10.0 30 
[37] M. Blanke, M. Kinnaert, J. Lunze, and M. Staroswiecki, Diagnosis and 
Fault -Tolerant Control. Berlin, Heidelberg: S pringer Berlin Heidelberg, 
2003  
------------------------------End of the page -----------------------------------
